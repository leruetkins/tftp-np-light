!function(t){var e={};function n(r){if(e[r])return e[r].exports;var i=e[r]={i:r,l:!1,exports:{}};return t[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)n.d(r,i,function(e){return t[e]}.bind(null,i));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="/",n(n.s=2)}([function(t,e,n){t.exports=n(3)},function(t,e){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(t){"object"==typeof window&&(n=window)}t.exports=n},function(t,e,n){n(10),t.exports=n(11)},function(t,e,n){var r=function(t){"use strict";var e,n=Object.prototype,r=n.hasOwnProperty,i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",o=i.asyncIterator||"@@asyncIterator",s=i.toStringTag||"@@toStringTag";function u(t,e,n,r){var i=e&&e.prototype instanceof y?e:y,a=Object.create(i.prototype),o=new A(r||[]);return a._invoke=function(t,e,n){var r=c;return function(i,a){if(r===h)throw new Error("Generator is already running");if(r===d){if("throw"===i)throw a;return P()}for(n.method=i,n.arg=a;;){var o=n.delegate;if(o){var s=S(o,n);if(s){if(s===p)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(r===c)throw r=d,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r=h;var u=l(t,e,n);if("normal"===u.type){if(r=n.done?d:f,u.arg===p)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(r=d,n.method="throw",n.arg=u.arg)}}}(t,n,o),a}function l(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}t.wrap=u;var c="suspendedStart",f="suspendedYield",h="executing",d="completed",p={};function y(){}function g(){}function m(){}var v={};v[a]=function(){return this};var _=Object.getPrototypeOf,b=_&&_(_(C([])));b&&b!==n&&r.call(b,a)&&(v=b);var T=m.prototype=y.prototype=Object.create(v);function w(t){["next","throw","return"].forEach((function(e){t[e]=function(t){return this._invoke(e,t)}}))}function k(t){var e;this._invoke=function(n,i){function a(){return new Promise((function(e,a){!function e(n,i,a,o){var s=l(t[n],t,i);if("throw"!==s.type){var u=s.arg,c=u.value;return c&&"object"==typeof c&&r.call(c,"__await")?Promise.resolve(c.__await).then((function(t){e("next",t,a,o)}),(function(t){e("throw",t,a,o)})):Promise.resolve(c).then((function(t){u.value=t,a(u)}),(function(t){return e("throw",t,a,o)}))}o(s.arg)}(n,i,e,a)}))}return e=e?e.then(a,a):a()}}function S(t,n){var r=t.iterator[n.method];if(r===e){if(n.delegate=null,"throw"===n.method){if(t.iterator.return&&(n.method="return",n.arg=e,S(t,n),"throw"===n.method))return p;n.method="throw",n.arg=new TypeError("The iterator does not provide a 'throw' method")}return p}var i=l(r,t.iterator,n.arg);if("throw"===i.type)return n.method="throw",n.arg=i.arg,n.delegate=null,p;var a=i.arg;return a?a.done?(n[t.resultName]=a.value,n.next=t.nextLoc,"return"!==n.method&&(n.method="next",n.arg=e),n.delegate=null,p):a:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,p)}function R(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function E(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function A(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(R,this),this.reset(!0)}function C(t){if(t){var n=t[a];if(n)return n.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var i=-1,o=function n(){for(;++i<t.length;)if(r.call(t,i))return n.value=t[i],n.done=!1,n;return n.value=e,n.done=!0,n};return o.next=o}}return{next:P}}function P(){return{value:e,done:!0}}return g.prototype=T.constructor=m,m.constructor=g,m[s]=g.displayName="GeneratorFunction",t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===g||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,m):(t.__proto__=m,s in t||(t[s]="GeneratorFunction")),t.prototype=Object.create(T),t},t.awrap=function(t){return{__await:t}},w(k.prototype),k.prototype[o]=function(){return this},t.AsyncIterator=k,t.async=function(e,n,r,i){var a=new k(u(e,n,r,i));return t.isGeneratorFunction(n)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},w(T),T[s]="Generator",T[a]=function(){return this},T.toString=function(){return"[object Generator]"},t.keys=function(t){var e=[];for(var n in t)e.push(n);return e.reverse(),function n(){for(;e.length;){var r=e.pop();if(r in t)return n.value=r,n.done=!1,n}return n.done=!0,n}},t.values=C,A.prototype={constructor:A,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(E),!t)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=e)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var n=this;function i(r,i){return s.type="throw",s.arg=t,n.next=r,i&&(n.method="next",n.arg=e),!!i}for(var a=this.tryEntries.length-1;a>=0;--a){var o=this.tryEntries[a],s=o.completion;if("root"===o.tryLoc)return i("end");if(o.tryLoc<=this.prev){var u=r.call(o,"catchLoc"),l=r.call(o,"finallyLoc");if(u&&l){if(this.prev<o.catchLoc)return i(o.catchLoc,!0);if(this.prev<o.finallyLoc)return i(o.finallyLoc)}else if(u){if(this.prev<o.catchLoc)return i(o.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return i(o.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&r.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var a=i;break}}a&&("break"===t||"continue"===t)&&a.tryLoc<=e&&e<=a.finallyLoc&&(a=null);var o=a?a.completion:{};return o.type=t,o.arg=e,a?(this.method="next",this.next=a.finallyLoc,p):this.complete(o)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),p},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),E(n),p}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var i=r.arg;E(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(t,n,r){return this.delegate={iterator:C(t),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=e),p}},t}(t.exports);try{regeneratorRuntime=r}catch(t){Function("r","regeneratorRuntime = r")(r)}},function(t,e,n){(function(n,r,i){var a,o,s,u;function l(t){return(l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var c,f=f||{};f.scope={},f.ASSUME_ES5=!1,f.ASSUME_NO_NATIVE_MAP=!1,f.ASSUME_NO_NATIVE_SET=!1,f.defineProperty=f.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(t,e,n){t!=Array.prototype&&t!=Object.prototype&&(t[e]=n.value)},f.getGlobal=function(t){return"undefined"!=typeof window&&window===t?t:void 0!==n&&null!=n?n:t},f.global=f.getGlobal(this),f.polyfill=function(t,e,n,r){if(e){for(n=f.global,t=t.split("."),r=0;r<t.length-1;r++){var i=t[r];i in n||(n[i]={}),n=n[i]}(e=e(r=n[t=t[t.length-1]]))!=r&&null!=e&&f.defineProperty(n,t,{configurable:!0,writable:!0,value:e})}},f.polyfill("Object.setPrototypeOf",(function(t){return t||("object"!=l("".__proto__)?null:function(t,e){if(t.__proto__=e,t.__proto__!==e)throw new TypeError(t+" is not extensible");return t})}),"es6","es5"),c=function(){return function t(e,n,r){function i(o,s){if(!n[o]){if(!e[o]){if(!s&&"function"==typeof u&&u)return u(o,!0);if(a)return a(o,!0);throw(s=Error("Cannot find module '"+o+"'")).code="MODULE_NOT_FOUND",s}s=n[o]={exports:{}},e[o][0].call(s.exports,(function(t){var n=e[o][1][t];return i(n||t)}),s,s.exports,t,e,n,r)}return n[o].exports}for(var a="function"==typeof u&&u,o=0;o<r.length;o++)i(r[o]);return i}({1:[function(t,e,n){},{}],2:[function(t,e,n){e.exports=XMLHttpRequest},{}],3:[function(t,e,n){function i(t){return(i="function"==typeof Symbol&&"symbol"===l(Symbol.iterator)?function(t){return l(t)}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":l(t)})(t)}function a(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function o(t){return(o=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function s(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function u(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&c(t,e)}function c(t,e){return(c=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function f(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}t=function(t){function e(t){if(!(this instanceof e))throw new TypeError("Cannot call a class as a function");var n=o(e).call(this);return n=!n||"object"!==i(n)&&"function"!=typeof n?s(this):n,f(s(n),"_array",void 0),f(s(n),"_size",void 0),n._array=t,n._size=t.length,n._isInitialized=!0,n}return u(e,t),function(t,e,n){e&&a(t.prototype,e),n&&a(t,n)}(e,[{key:"init",value:function(t){setTimeout(t.onSuccess,0)}},{key:"loadRange",value:function(t,e){setTimeout(e.onSuccess,0)}},{key:"getByteAt",value:function(t){if(t>=this._array.length)throw Error("Offset "+t+" hasn't been loaded yet.");return this._array[t]}}],[{key:"canReadFile",value:function(t){return Array.isArray(t)||"function"==typeof r&&r.isBuffer(t)}}]),e}(t("./MediaFileReader")),e.exports=t},{"./MediaFileReader":11}],4:[function(t,e,n){function r(t){return(r="function"==typeof Symbol&&"symbol"===l(Symbol.iterator)?function(t){return l(t)}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":l(t)})(t)}function i(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function a(t){return(a=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function o(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function s(t,e){return(s=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function u(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var c=t("./ChunkedFileData");t=function(t){function e(t){if(!(this instanceof e))throw new TypeError("Cannot call a class as a function");var n=a(e).call(this);return n=!n||"object"!==r(n)&&"function"!=typeof n?o(this):n,u(o(n),"_blob",void 0),u(o(n),"_fileData",void 0),n._blob=t,n._fileData=new c,n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&s(t,e)}(e,t),function(t,e,n){e&&i(t.prototype,e),n&&i(t,n)}(e,[{key:"_init",value:function(t){this._size=this._blob.size,setTimeout(t.onSuccess,1)}},{key:"loadRange",value:function(t,e){var n=this,r=(this._blob.slice||this._blob.mozSlice||this._blob.webkitSlice).call(this._blob,t[0],t[1]+1),i=new FileReader;i.onloadend=function(r){r=new Uint8Array(i.result),n._fileData.addData(t[0],r),e.onSuccess()},i.onerror=i.onabort=function(t){e.onError&&e.onError({type:"blob",info:i.error})},i.readAsArrayBuffer(r)}},{key:"getByteAt",value:function(t){return this._fileData.getByteAt(t)}}],[{key:"canReadFile",value:function(t){return"undefined"!=typeof Blob&&t instanceof Blob||"undefined"!=typeof File&&t instanceof File}}]),e}(t("./MediaFileReader")),e.exports=t},{"./ChunkedFileData":5,"./MediaFileReader":11}],5:[function(t,e,n){function r(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function i(t,e,n){return e&&r(t.prototype,e),n&&r(t,n),t}t=function(){function t(){if(!(this instanceof t))throw new TypeError("Cannot call a class as a function");"_fileData"in this?Object.defineProperty(this,"_fileData",{value:void 0,enumerable:!0,configurable:!0,writable:!0}):this._fileData=void 0,this._fileData=[]}return i(t,null,[{key:"NOT_FOUND",get:function(){return-1}}]),i(t,[{key:"addData",value:function(t,e){var n=t+e.length-1,r=this._getChunkRange(t,n);if(-1===r.startIx)this._fileData.splice(r.insertIx||0,0,{offset:t,data:e});else{var i=this._fileData[r.startIx],a=this._fileData[r.endIx];n=n<a.offset+a.data.length-1;var o={offset:Math.min(t,i.offset),data:e};t>i.offset&&(t=this._sliceData(i.data,0,t-i.offset),o.data=this._concatData(t,e)),n&&(t=this._sliceData(o.data,0,a.offset-o.offset),o.data=this._concatData(t,a.data)),this._fileData.splice(r.startIx,r.endIx-r.startIx+1,o)}}},{key:"_concatData",value:function(t,e){if("undefined"!=typeof ArrayBuffer&&ArrayBuffer.isView&&ArrayBuffer.isView(t)){var n=new t.constructor(t.length+e.length);return n.set(t,0),n.set(e,t.length),n}return t.concat(e)}},{key:"_sliceData",value:function(t,e,n){return t.slice?t.slice(e,n):t.subarray(e,n)}},{key:"_getChunkRange",value:function(t,e){for(var n,r,i=-1,a=-1,o=0,s=0;s<this._fileData.length&&(n=(r=this._fileData[s].offset)+this._fileData[s].data.length,!(e<r-1));o=++s)if(t<=n+1&&e>=r-1){i=s;break}if(-1===i)return{startIx:-1,endIx:-1,insertIx:o};for(s=i;s<this._fileData.length&&(e>=(r=this._fileData[s].offset)-1&&(a=s),!(e<=(n=r+this._fileData[s].data.length)+1));s++);return-1===a&&(a=i),{startIx:i,endIx:a}}},{key:"hasDataRange",value:function(t,e){for(var n=0;n<this._fileData.length;n++){var r=this._fileData[n];if(e<r.offset)break;if(t>=r.offset&&e<r.offset+r.data.length)return!0}return!1}},{key:"getByteAt",value:function(t){for(var e,n=0;n<this._fileData.length;n++){var r=this._fileData[n].offset,i=r+this._fileData[n].data.length-1;if(t>=r&&t<=i){e=this._fileData[n];break}}if(e)return e.data[t-e.offset];throw Error("Offset "+t+" hasn't been loaded yet.")}}]),t}(),e.exports=t},{}],6:[function(t,e,n){function r(t){return(r="function"==typeof Symbol&&"symbol"===l(Symbol.iterator)?function(t){return l(t)}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":l(t)})(t)}function i(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function a(t){return(a=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function o(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function s(t,e){return(s=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function u(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var c=[4,132],f=[6,134],h="Other;32x32 pixels 'file icon' (PNG only);Other file icon;Cover (front);Cover (back);Leaflet page;Media (e.g. label side of CD);Lead artist/lead performer/soloist;Artist/performer;Conductor;Band/Orchestra;Composer;Lyricist/text writer;Recording Location;During recording;During performance;Movie/video screen capture;A bright coloured fish;Illustration;Band/artist logotype;Publisher/Studio logotype".split(";");t=function(t){function e(){var t;if(!(this instanceof e))throw new TypeError("Cannot call a class as a function");for(var n=arguments.length,i=Array(n),s=0;s<n;s++)i[s]=arguments[s];return n=(t=a(e)).call.apply(t,[this].concat(i)),t=!n||"object"!==r(n)&&"function"!=typeof n?o(this):n,u(o(t),"_commentOffset",void 0),u(o(t),"_pictureOffset",void 0),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&s(t,e)}(e,t),function(t,e,n){e&&i(t.prototype,e),n&&i(t,n)}(e,[{key:"_loadData",value:function(t,e){var n=this;t.loadRange([4,7],{onSuccess:function(){n._loadBlock(t,4,e)}})}},{key:"_loadBlock",value:function(t,e,n){var r=this,i=t.getByteAt(e),a=t.getInteger24At(e+1,!0);if(-1!==c.indexOf(i)){var o=e+4;t.loadRange([o,o+a],{onSuccess:function(){r._commentOffset=o,r._nextBlock(t,e,i,a,n)}})}else-1!==f.indexOf(i)?(o=e+4,t.loadRange([o,o+a],{onSuccess:function(){r._pictureOffset=o,r._nextBlock(t,e,i,a,n)}})):r._nextBlock(t,e,i,a,n)}},{key:"_nextBlock",value:function(t,e,n,r,i){var a=this;127<n?a._commentOffset?i.onSuccess():i.onError({type:"loadData",info:"Comment block could not be found."}):t.loadRange([e+4+r,e+4+4+r],{onSuccess:function(){a._loadBlock(t,e+4+r,i)}})}},{key:"_parseData",value:function(t,e){var n=t.getLongAt(this._commentOffset,!1)+(this._commentOffset+4);e=t.getLongAt(n,!1),n+=4;for(var r,i,a,o,s,u,l=0;l<e;l++){var c=t.getLongAt(n,!1),f=t.getStringWithCharsetAt(n+4,c,"utf-8").toString(),d=f.indexOf("=");switch((f=[f.slice(0,d),f.slice(d+1)])[0]){case"TITLE":r=f[1];break;case"ARTIST":i=f[1];break;case"ALBUM":a=f[1];break;case"TRACKNUMBER":o=f[1];break;case"GENRE":s=f[1]}n+=4+c}return this._pictureOffset&&(u=t.getLongAt(this._pictureOffset,!0),e=this._pictureOffset+4,n=t.getLongAt(e,!0),l=e+4,e=t.getStringAt(l,n),n=l+n,l=t.getLongAt(n,!0),c=n+4,n=t.getStringWithCharsetAt(c,l,"utf-8").toString(),l=c+l+16,c=t.getLongAt(l,!0),t=t.getBytesAt(l+4,c,!0),u={format:e,type:h[u],description:n,data:t}),{type:"FLAC",version:"1",tags:{title:r,artist:i,album:a,track:o,genre:s,picture:u}}}}],[{key:"getTagIdentifierByteRange",value:function(){return{offset:0,length:4}}},{key:"canReadTagFormat",value:function(t){return"fLaC"===String.fromCharCode.apply(String,t.slice(0,4))}}]),e}(t("./MediaTagReader")),e.exports=t},{"./MediaTagReader":12}],7:[function(t,e,n){function r(t){return(r="function"==typeof Symbol&&"symbol"===l(Symbol.iterator)?function(t){return l(t)}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":l(t)})(t)}function i(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function a(t){return(a=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&s(t,e)}function s(t,e){return(s=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}n=t("./MediaTagReader"),t("./MediaFileReader"),t=function(t){function e(){if(!(this instanceof e))throw new TypeError("Cannot call a class as a function");var t=a(e).apply(this,arguments);if(!t||"object"!==r(t)&&"function"!=typeof t){if(void 0===this)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");t=this}return t}return o(e,t),function(t,e,n){e&&i(t.prototype,e),n&&i(t,n)}(e,[{key:"_loadData",value:function(t,e){var n=t.getSize();t.loadRange([n-128,n-1],e)}},{key:"_parseData",value:function(t,e){var n=t.getSize()-128,r=t.getStringWithCharsetAt(n+3,30).toString(),i=t.getStringWithCharsetAt(n+33,30).toString(),a=t.getStringWithCharsetAt(n+63,30).toString(),o=t.getStringWithCharsetAt(n+93,4).toString(),s=t.getByteAt(n+97+28);if(e=t.getByteAt(n+97+29),0==s&&0!=e){var l="1.1";s=t.getStringWithCharsetAt(n+97,28).toString()}else l="1.0",s=t.getStringWithCharsetAt(n+97,30).toString(),e=0;return t={type:"ID3",version:l,tags:{title:r,artist:i,album:a,year:o,comment:s,genre:255>(t=t.getByteAt(n+97+30))?u[t]:""}},e&&(t.tags.track=e),t}}],[{key:"getTagIdentifierByteRange",value:function(){return{offset:-128,length:128}}},{key:"canReadTagFormat",value:function(t){return"TAG"===String.fromCharCode.apply(String,t.slice(0,3))}}]),e}(n);var u="Blues;Classic Rock;Country;Dance;Disco;Funk;Grunge;Hip-Hop;Jazz;Metal;New Age;Oldies;Other;Pop;R&B;Rap;Reggae;Rock;Techno;Industrial;Alternative;Ska;Death Metal;Pranks;Soundtrack;Euro-Techno;Ambient;Trip-Hop;Vocal;Jazz+Funk;Fusion;Trance;Classical;Instrumental;Acid;House;Game;Sound Clip;Gospel;Noise;AlternRock;Bass;Soul;Punk;Space;Meditative;Instrumental Pop;Instrumental Rock;Ethnic;Gothic;Darkwave;Techno-Industrial;Electronic;Pop-Folk;Eurodance;Dream;Southern Rock;Comedy;Cult;Gangsta;Top 40;Christian Rap;Pop/Funk;Jungle;Native American;Cabaret;New Wave;Psychadelic;Rave;Showtunes;Trailer;Lo-Fi;Tribal;Acid Punk;Acid Jazz;Polka;Retro;Musical;Rock & Roll;Hard Rock;Folk;Folk-Rock;National Folk;Swing;Fast Fusion;Bebob;Latin;Revival;Celtic;Bluegrass;Avantgarde;Gothic Rock;Progressive Rock;Psychedelic Rock;Symphonic Rock;Slow Rock;Big Band;Chorus;Easy Listening;Acoustic;Humour;Speech;Chanson;Opera;Chamber Music;Sonata;Symphony;Booty Bass;Primus;Porn Groove;Satire;Slow Jam;Club;Tango;Samba;Folklore;Ballad;Power Ballad;Rhythmic Soul;Freestyle;Duet;Punk Rock;Drum Solo;Acapella;Euro-House;Dance Hall".split(";");e.exports=t},{"./MediaFileReader":11,"./MediaTagReader":12}],8:[function(t,e,n){function r(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function i(t){switch(t){case 0:t="iso-8859-1";break;case 1:t="utf-16";break;case 2:t="utf-16be";break;case 3:t="utf-8";break;default:t="iso-8859-1"}return t}function a(t,e,n,r){return r=n.getStringWithCharsetAt(t+1,e-1,r),t=n.getStringWithCharsetAt(t+1+r.bytesReadCount,e-1-r.bytesReadCount),{user_description:r.toString(),data:t.toString()}}t("./MediaFileReader");var o=t("./StringUtils"),s=t("./ArrayFileReader"),u={BUF:"Recommended buffer size",CNT:"Play counter",COM:"Comments",CRA:"Audio encryption",CRM:"Encrypted meta frame",ETC:"Event timing codes",EQU:"Equalization",GEO:"General encapsulated object",IPL:"Involved people list",LNK:"Linked information",MCI:"Music CD Identifier",MLL:"MPEG location lookup table",PIC:"Attached picture",POP:"Popularimeter",REV:"Reverb",RVA:"Relative volume adjustment",SLT:"Synchronized lyric/text",STC:"Synced tempo codes",TAL:"Album/Movie/Show title",TBP:"BPM (Beats Per Minute)",TCM:"Composer",TCO:"Content type",TCR:"Copyright message",TDA:"Date",TDY:"Playlist delay",TEN:"Encoded by",TFT:"File type",TIM:"Time",TKE:"Initial key",TLA:"Language(s)",TLE:"Length",TMT:"Media type",TOA:"Original artist(s)/performer(s)",TOF:"Original filename",TOL:"Original Lyricist(s)/text writer(s)",TOR:"Original release year",TOT:"Original album/Movie/Show title",TP1:"Lead artist(s)/Lead performer(s)/Soloist(s)/Performing group",TP2:"Band/Orchestra/Accompaniment",TP3:"Conductor/Performer refinement",TP4:"Interpreted, remixed, or otherwise modified by",TPA:"Part of a set",TPB:"Publisher",TRC:"ISRC (International Standard Recording Code)",TRD:"Recording dates",TRK:"Track number/Position in set",TSI:"Size",TSS:"Software/hardware and settings used for encoding",TT1:"Content group description",TT2:"Title/Songname/Content description",TT3:"Subtitle/Description refinement",TXT:"Lyricist/text writer",TXX:"User defined text information frame",TYE:"Year",UFI:"Unique file identifier",ULT:"Unsychronized lyric/text transcription",WAF:"Official audio file webpage",WAR:"Official artist/performer webpage",WAS:"Official audio source webpage",WCM:"Commercial information",WCP:"Copyright/Legal information",WPB:"Publishers official webpage",WXX:"User defined URL link frame",AENC:"Audio encryption",APIC:"Attached picture",ASPI:"Audio seek point index",CHAP:"Chapter",CTOC:"Table of contents",COMM:"Comments",COMR:"Commercial frame",ENCR:"Encryption method registration",EQU2:"Equalisation (2)",EQUA:"Equalization",ETCO:"Event timing codes",GEOB:"General encapsulated object",GRID:"Group identification registration",IPLS:"Involved people list",LINK:"Linked information",MCDI:"Music CD identifier",MLLT:"MPEG location lookup table",OWNE:"Ownership frame",PRIV:"Private frame",PCNT:"Play counter",POPM:"Popularimeter",POSS:"Position synchronisation frame",RBUF:"Recommended buffer size",RVA2:"Relative volume adjustment (2)",RVAD:"Relative volume adjustment",RVRB:"Reverb",SEEK:"Seek frame",SYLT:"Synchronized lyric/text",SYTC:"Synchronized tempo codes",TALB:"Album/Movie/Show title",TBPM:"BPM (beats per minute)",TCOM:"Composer",TCON:"Content type",TCOP:"Copyright message",TDAT:"Date",TDLY:"Playlist delay",TDRC:"Recording time",TDRL:"Release time",TDTG:"Tagging time",TENC:"Encoded by",TEXT:"Lyricist/Text writer",TFLT:"File type",TIME:"Time",TIPL:"Involved people list",TIT1:"Content group description",TIT2:"Title/songname/content description",TIT3:"Subtitle/Description refinement",TKEY:"Initial key",TLAN:"Language(s)",TLEN:"Length",TMCL:"Musician credits list",TMED:"Media type",TMOO:"Mood",TOAL:"Original album/movie/show title",TOFN:"Original filename",TOLY:"Original lyricist(s)/text writer(s)",TOPE:"Original artist(s)/performer(s)",TORY:"Original release year",TOWN:"File owner/licensee",TPE1:"Lead performer(s)/Soloist(s)",TPE2:"Band/orchestra/accompaniment",TPE3:"Conductor/performer refinement",TPE4:"Interpreted, remixed, or otherwise modified by",TPOS:"Part of a set",TPRO:"Produced notice",TPUB:"Publisher",TRCK:"Track number/Position in set",TRDA:"Recording dates",TRSN:"Internet radio station name",TRSO:"Internet radio station owner",TSOA:"Album sort order",TSOP:"Performer sort order",TSOT:"Title sort order",TSIZ:"Size",TSRC:"ISRC (international standard recording code)",TSSE:"Software/Hardware and settings used for encoding",TSST:"Set subtitle",TYER:"Year",TXXX:"User defined text information frame",UFID:"Unique file identifier",USER:"Terms of use",USLT:"Unsychronized lyric/text transcription",WCOM:"Commercial information",WCOP:"Copyright/Legal information",WOAF:"Official audio file webpage",WOAR:"Official artist/performer webpage",WOAS:"Official audio source webpage",WORS:"Official internet radio station homepage",WPAY:"Payment",WPUB:"Publishers official webpage",WXXX:"User defined URL link frame"};t=function(){function t(){if(!(this instanceof t))throw new TypeError("Cannot call a class as a function")}return function(t,e,n){e&&r(t.prototype,e),n&&r(t,n)}(t,null,[{key:"getFrameReaderFunction",value:function(t){return t in l?l[t]:"T"===t[0]?l["T*"]:"W"===t[0]?l["W*"]:null}},{key:"readFrames",value:function(e,n,r,i,a){for(var o={},s=this._getFrameHeaderSize(i);e<n-s;){var u=this._readFrameHeader(r,e,i),l=u.id;if(!l)break;var c=u.flags,f=u.size,h=e+u.headerSize,d=r;if(e+=u.headerSize+u.size,!a||-1!==a.indexOf(l)){if("MP3e"===l||"\0MP3"===l||"\0\0MP"===l||" MP3"===l)break;c&&c.format.unsynchronisation&&(d=this.getUnsyncFileReader(d,h,f),h=0,f=d.getSize()),c&&c.format.data_length_indicator&&(h+=4,f-=4),c=(u=t.getFrameReaderFunction(l))?u.apply(this,[h,f,d,c,i]):null,f={id:l,size:f,description:h=this._getFrameDescription(l),data:c},l in o?(o[l].id&&(o[l]=[o[l]]),o[l].push(f)):o[l]=f}}return o}},{key:"_getFrameHeaderSize",value:function(t){return 2==(t=t.major)?6:3==t||4==t?10:0}},{key:"_readFrameHeader",value:function(t,e,n){var r=n.major,i=null;switch(n=this._getFrameHeaderSize(n),r){case 2:var a=t.getStringAt(e,3),o=t.getInteger24At(e+3,!0);break;case 3:a=t.getStringAt(e,4),o=t.getLongAt(e+4,!0);break;case 4:a=t.getStringAt(e,4),o=t.getSynchsafeInteger32At(e+4)}return a!=String.fromCharCode(0,0,0)&&a!=String.fromCharCode(0,0,0,0)||(a=""),a&&2<r&&(i=this._readFrameFlags(t,e+8)),{id:a||"",size:o||0,headerSize:n||0,flags:i}}},{key:"_readFrameFlags",value:function(t,e){return{message:{tag_alter_preservation:t.isBitSetAt(e,6),file_alter_preservation:t.isBitSetAt(e,5),read_only:t.isBitSetAt(e,4)},format:{grouping_identity:t.isBitSetAt(e+1,7),compression:t.isBitSetAt(e+1,3),encryption:t.isBitSetAt(e+1,2),unsynchronisation:t.isBitSetAt(e+1,1),data_length_indicator:t.isBitSetAt(e+1,0)}}}},{key:"_getFrameDescription",value:function(t){return t in u?u[t]:"Unknown"}},{key:"getUnsyncFileReader",value:function(t,e,n){for(t=t.getBytesAt(e,n),e=0;e<t.length-1;e++)255===t[e]&&0===t[e+1]&&t.splice(e+1,1);return new s(t)}}]),t}();var l={APIC:function(t,e,n,r,a){r=t;var o=i(n.getByteAt(t));switch(a&&a.major){case 2:a=n.getStringAt(t+1,3),t+=4;break;case 3:case 4:t+=1+(a=n.getStringWithCharsetAt(t+1,e-1)).bytesReadCount;break;default:throw Error("Couldn't read ID3v2 major version.")}var s=n.getByteAt(t);return s=c[s],t+=1+(o=n.getStringWithCharsetAt(t+1,e-(t-r)-1,o)).bytesReadCount,{format:a.toString(),type:s,description:o.toString(),data:n.getBytesAt(t,r+e-t)}},CHAP:function(t,e,n,r,i){r=t;var a={},s=o.readNullTerminatedString(n.getBytesAt(t,e));return a.id=s.toString(),t+=s.bytesReadCount,a.startTime=n.getLongAt(t,!0),t+=4,a.endTime=n.getLongAt(t,!0),t+=4,a.startOffset=n.getLongAt(t,!0),t+=4,a.endOffset=n.getLongAt(t,!0),t+=4,a.subFrames=this.readFrames(t,t+(e-(t-r)),n,i),a},CTOC:function(t,e,n,r,i){r=t;var a={childElementIds:[],id:void 0,topLevel:void 0,ordered:void 0,entryCount:void 0,subFrames:void 0},s=o.readNullTerminatedString(n.getBytesAt(t,e));for(a.id=s.toString(),t+=s.bytesReadCount,a.topLevel=n.isBitSetAt(t,1),a.ordered=n.isBitSetAt(t,0),t++,a.entryCount=n.getByteAt(t),t++,s=0;s<a.entryCount;s++){var u=o.readNullTerminatedString(n.getBytesAt(t,e-(t-r)));a.childElementIds.push(u.toString()),t+=u.bytesReadCount}return a.subFrames=this.readFrames(t,t+(e-(t-r)),n,i),a},COMM:function(t,e,n,r,a){var o=t,s=i(n.getByteAt(t));return r=n.getStringAt(t+1,3),t+=4+(a=n.getStringWithCharsetAt(t+4,e-4,s)).bytesReadCount,t=n.getStringWithCharsetAt(t,o+e-t,s),{language:r,short_description:a.toString(),text:t.toString()}}};l.COM=l.COMM,l.PIC=function(t,e,n,r,i){return l.APIC(t,e,n,r,i)},l.PCNT=function(t,e,n,r,i){return n.getLongAt(t,!1)},l.CNT=l.PCNT,l["T*"]=function(t,e,n,r,a){return r=i(n.getByteAt(t)),n.getStringWithCharsetAt(t+1,e-1,r).toString()},l.TXXX=function(t,e,n,r,o){return r=i(n.getByteAt(t)),a(t,e,n,r)},l.WXXX=function(t,e,n,r,o){return 0===e?null:(r=i(n.getByteAt(t)),a(t,e,n,r))},l["W*"]=function(t,e,n,r,i){return 0===e?null:n.getStringWithCharsetAt(t,e,"iso-8859-1").toString()},l.TCON=function(t,e,n,r){return l["T*"].apply(this,arguments).replace(/^\(\d+\)/,"")},l.TCO=l.TCON,l.USLT=function(t,e,n,r,a){var o=t,s=i(n.getByteAt(t));return r=n.getStringAt(t+1,3),t+=4+(a=n.getStringWithCharsetAt(t+4,e-4,s)).bytesReadCount,t=n.getStringWithCharsetAt(t,o+e-t,s),{language:r,descriptor:a.toString(),lyrics:t.toString()}},l.ULT=l.USLT,l.UFID=function(t,e,n,r,i){return t+=(r=o.readNullTerminatedString(n.getBytesAt(t,e))).bytesReadCount,t=n.getBytesAt(t,e-r.bytesReadCount),{ownerIdentifier:r.toString(),identifier:t}};var c="Other;32x32 pixels 'file icon' (PNG only);Other file icon;Cover (front);Cover (back);Leaflet page;Media (e.g. label side of CD);Lead artist/lead performer/soloist;Artist/performer;Conductor;Band/Orchestra;Composer;Lyricist/text writer;Recording Location;During recording;During performance;Movie/video screen capture;A bright coloured fish;Illustration;Band/artist logotype;Publisher/Studio logotype".split(";");e.exports=t},{"./ArrayFileReader":3,"./MediaFileReader":11,"./StringUtils":13}],9:[function(t,e,n){function r(t){return(r="function"==typeof Symbol&&"symbol"===l(Symbol.iterator)?function(t){return l(t)}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":l(t)})(t)}function i(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function a(t){return(a=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&s(t,e)}function s(t,e){return(s=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}n=t("./MediaTagReader"),t("./MediaFileReader");var u=t("./ID3v2FrameReader");t=function(t){function e(){if(!(this instanceof e))throw new TypeError("Cannot call a class as a function");var t=a(e).apply(this,arguments);if(!t||"object"!==r(t)&&"function"!=typeof t){if(void 0===this)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");t=this}return t}return o(e,t),function(t,e,n){e&&i(t.prototype,e),n&&i(t,n)}(e,[{key:"_loadData",value:function(t,e){t.loadRange([6,9],{onSuccess:function(){t.loadRange([0,10+t.getSynchsafeInteger32At(6)-1],e)},onError:e.onError})}},{key:"_parseData",value:function(t,e){var n,r=0,i=t.getByteAt(r+3);if(4<i)return{type:"ID3",version:">2.4",tags:{}};var a=t.getByteAt(r+4),o=t.isBitSetAt(r+5,7),s=t.isBitSetAt(r+5,6),l=t.isBitSetAt(r+5,5),f=t.getSynchsafeInteger32At(r+6);if(r+=10,s)if(4===i){var h=t.getSynchsafeInteger32At(r);r+=h}else r+=(h=t.getLongAt(r,!0))+4;for(var d in h={type:"ID3",version:"2."+i+"."+a,major:i,revision:a,flags:{unsynchronisation:o,extended_header:s,experimental_indicator:l,footer_present:!1},size:f,tags:{}},e&&(n=this._expandShortcutTags(e)),e=f+10,h.flags.unsynchronisation&&(t=u.getUnsyncFileReader(t,r,f),r=0,e=t.getSize()),t=u.readFrames(r,e,t,h,n),c)c.hasOwnProperty(d)&&(n=this._getFrameData(t,c[d]))&&(h.tags[d]=n);for(var p in t)t.hasOwnProperty(p)&&(h.tags[p]=t[p]);return h}},{key:"_getFrameData",value:function(t,e){for(var n,r=0;n=e[r];r++)if(n in t)return(t=t[n]instanceof Array?t[n][0]:t[n]).data}},{key:"getShortcuts",value:function(){return c}}],[{key:"getTagIdentifierByteRange",value:function(){return{offset:0,length:10}}},{key:"canReadTagFormat",value:function(t){return"ID3"===String.fromCharCode.apply(String,t.slice(0,3))}}]),e}(n);var c={title:["TIT2","TT2"],artist:["TPE1","TP1"],album:["TALB","TAL"],year:["TYER","TYE"],comment:["COMM","COM"],track:["TRCK","TRK"],genre:["TCON","TCO"],picture:["APIC","PIC"],lyrics:["USLT","ULT"]};e.exports=t},{"./ID3v2FrameReader":8,"./MediaFileReader":11,"./MediaTagReader":12}],10:[function(t,e,n){function r(t){return(r="function"==typeof Symbol&&"symbol"===l(Symbol.iterator)?function(t){return l(t)}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":l(t)})(t)}function i(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function a(t){return(a=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&s(t,e)}function s(t,e){return(s=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}n=t("./MediaTagReader"),t("./MediaFileReader"),t=function(t){function e(){if(!(this instanceof e))throw new TypeError("Cannot call a class as a function");var t=a(e).apply(this,arguments);if(!t||"object"!==r(t)&&"function"!=typeof t){if(void 0===this)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");t=this}return t}return o(e,t),function(t,e,n){e&&i(t.prototype,e),n&&i(t,n)}(e,[{key:"_loadData",value:function(t,e){var n=this;t.loadRange([0,16],{onSuccess:function(){n._loadAtom(t,0,"",e)},onError:e.onError})}},{key:"_loadAtom",value:function(t,e,n,r){if(e>=t.getSize())r.onSuccess();else{var i=this,a=t.getLongAt(e,!0);if(0==a||isNaN(a))r.onSuccess();else{var o=t.getStringAt(e+4,4);if(this._isContainerAtom(o)){"meta"==o&&(e+=4);var s=(n?n+".":"")+o;"moov.udta.meta.ilst"===s?t.loadRange([e,e+a],r):t.loadRange([e+8,e+8+8],{onSuccess:function(){i._loadAtom(t,e+8,s,r)},onError:r.onError})}else t.loadRange([e+a,e+a+8],{onSuccess:function(){i._loadAtom(t,e+a,n,r)},onError:r.onError})}}}},{key:"_isContainerAtom",value:function(t){return 0<=["moov","udta","meta","ilst"].indexOf(t)}},{key:"_canReadAtom",value:function(t){return"----"!==t}},{key:"_parseData",value:function(t,e){var n={};for(var r in e=this._expandShortcutTags(e),this._readAtom(n,t,0,t.getSize(),e),f)f.hasOwnProperty(r)&&(e=n[f[r]])&&(n[r]="track"===r?e.data.track:e.data);return{type:"MP4",ftyp:t.getStringAt(8,4),version:t.getLongAt(12,!0),tags:n}}},{key:"_readAtom",value:function(t,e,n,r,i,a,o){o=void 0===o?"":o+"  ";for(var s=n;s<n+r;){var u=e.getLongAt(s,!0);if(0==u)break;var l=e.getStringAt(s+4,4);if(this._isContainerAtom(l)){"meta"==l&&(s+=4),this._readAtom(t,e,s+8,u-8,i,(a?a+".":"")+l,o);break}(!i||0<=i.indexOf(l))&&"moov.udta.meta.ilst"===a&&this._canReadAtom(l)&&(t[l]=this._readMetadataAtom(e,s)),s+=u}}},{key:"_readMetadataAtom",value:function(t,e){var n=t.getLongAt(e,!0),r=t.getStringAt(e+4,4),i=t.getInteger24At(e+16+1,!0);if(i=u[i],"trkn"==r)var a={track:t.getByteAt(e+16+11),total:t.getByteAt(e+16+13)};else if("disk"==r)a={disk:t.getByteAt(e+16+11),total:t.getByteAt(e+16+13)};else{e+=24;var o=n-24;switch("covr"===r&&"uint8"===i&&(i="jpeg"),i){case"text":a=t.getStringWithCharsetAt(e,o,"utf-8").toString();break;case"uint8":a=t.getShortAt(e,!1);break;case"int":case"uint":a=("int"==i?1==o?t.getSByteAt:2==o?t.getSShortAt:4==o?t.getSLongAt:t.getLongAt:1==o?t.getByteAt:2==o?t.getShortAt:t.getLongAt).call(t,e+(8==o?4:0),!0);break;case"jpeg":case"png":a={format:"image/"+i,data:t.getBytesAt(e,o)}}}return{id:r,size:n,description:c[r]||"Unknown",data:a}}},{key:"getShortcuts",value:function(){return f}}],[{key:"getTagIdentifierByteRange",value:function(){return{offset:0,length:16}}},{key:"canReadTagFormat",value:function(t){return"ftyp"===String.fromCharCode.apply(String,t.slice(4,8))}}]),e}(n);var u={0:"uint8",1:"text",13:"jpeg",14:"png",21:"int",22:"uint"},c={"©alb":"Album","©ART":"Artist",aART:"Album Artist","©day":"Release Date","©nam":"Title","©gen":"Genre",gnre:"Genre",trkn:"Track Number","©wrt":"Composer","©too":"Encoding Tool","©enc":"Encoded By",cprt:"Copyright",covr:"Cover Art","©grp":"Grouping",keyw:"Keywords","©lyr":"Lyrics","©cmt":"Comment",tmpo:"Tempo",cpil:"Compilation",disk:"Disc Number",tvsh:"TV Show Name",tven:"TV Episode ID",tvsn:"TV Season",tves:"TV Episode",tvnn:"TV Network",desc:"Description",ldes:"Long Description",sonm:"Sort Name",soar:"Sort Artist",soaa:"Sort Album",soco:"Sort Composer",sosn:"Sort Show",purd:"Purchase Date",pcst:"Podcast",purl:"Podcast URL",catg:"Category",hdvd:"HD Video",stik:"Media Type",rtng:"Content Rating",pgap:"Gapless Playback",apID:"Purchase Account",sfID:"Country Code",atID:"Artist ID",cnID:"Catalog ID",plID:"Collection ID",geID:"Genre ID","xid ":"Vendor Information",flvr:"Codec Flavor"},f={title:"©nam",artist:"©ART",album:"©alb",year:"©day",comment:"©cmt",track:"trkn",genre:"©gen",picture:"covr",lyrics:"©lyr"};e.exports=t},{"./MediaFileReader":11,"./MediaTagReader":12}],11:[function(t,e,n){function r(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function i(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var a=t("./StringUtils");t=function(){function t(e){if(!(this instanceof t))throw new TypeError("Cannot call a class as a function");i(this,"_isInitialized",void 0),i(this,"_size",void 0),this._isInitialized=!1,this._size=0}return function(t,e,n){e&&r(t.prototype,e),n&&r(t,n)}(t,[{key:"init",value:function(t){var e=this;if(!this._isInitialized)return this._init({onSuccess:function(){e._isInitialized=!0,t.onSuccess()},onError:t.onError});setTimeout(t.onSuccess,1)}},{key:"_init",value:function(t){throw Error("Must implement init function")}},{key:"loadRange",value:function(t,e){throw Error("Must implement loadRange function")}},{key:"getSize",value:function(){if(!this._isInitialized)throw Error("init() must be called first.");return this._size}},{key:"getByteAt",value:function(t){throw Error("Must implement getByteAt function")}},{key:"getBytesAt",value:function(t,e){for(var n=Array(e),r=0;r<e;r++)n[r]=this.getByteAt(t+r);return n}},{key:"isBitSetAt",value:function(t,e){return 0!=(this.getByteAt(t)&1<<e)}},{key:"getSByteAt",value:function(t){return 127<(t=this.getByteAt(t))?t-256:t}},{key:"getShortAt",value:function(t,e){return 0>(t=e?(this.getByteAt(t)<<8)+this.getByteAt(t+1):(this.getByteAt(t+1)<<8)+this.getByteAt(t))&&(t+=65536),t}},{key:"getSShortAt",value:function(t,e){return 32767<(t=this.getShortAt(t,e))?t-65536:t}},{key:"getLongAt",value:function(t,e){var n=this.getByteAt(t),r=this.getByteAt(t+1),i=this.getByteAt(t+2);return t=this.getByteAt(t+3),0>(e=e?(((n<<8)+r<<8)+i<<8)+t:(((t<<8)+i<<8)+r<<8)+n)&&(e+=4294967296),e}},{key:"getSLongAt",value:function(t,e){return 2147483647<(t=this.getLongAt(t,e))?t-4294967296:t}},{key:"getInteger24At",value:function(t,e){var n=this.getByteAt(t),r=this.getByteAt(t+1);return t=this.getByteAt(t+2),0>(e=e?((n<<8)+r<<8)+t:((t<<8)+r<<8)+n)&&(e+=16777216),e}},{key:"getStringAt",value:function(t,e){for(var n=[],r=t,i=0;r<t+e;r++,i++)n[i]=String.fromCharCode(this.getByteAt(r));return n.join("")}},{key:"getStringWithCharsetAt",value:function(t,e,n){switch(t=this.getBytesAt(t,e),(n||"").toLowerCase()){case"utf-16":case"utf-16le":case"utf-16be":n=a.readUTF16String(t,"utf-16be"===n);break;case"utf-8":n=a.readUTF8String(t);break;default:n=a.readNullTerminatedString(t)}return n}},{key:"getCharAt",value:function(t){return String.fromCharCode(this.getByteAt(t))}},{key:"getSynchsafeInteger32At",value:function(t){var e=this.getByteAt(t),n=this.getByteAt(t+1),r=this.getByteAt(t+2);return 127&this.getByteAt(t+3)|(127&r)<<7|(127&n)<<14|(127&e)<<21}}],[{key:"canReadFile",value:function(t){throw Error("Must implement canReadFile function")}}]),t}(),e.exports=t},{"./StringUtils":13}],12:[function(t,e,n){function r(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function i(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}t("./MediaFileReader"),t=function(){function t(e){if(!(this instanceof t))throw new TypeError("Cannot call a class as a function");i(this,"_mediaFileReader",void 0),i(this,"_tags",void 0),this._mediaFileReader=e,this._tags=null}return function(t,e,n){e&&r(t.prototype,e),n&&r(t,n)}(t,[{key:"setTagsToRead",value:function(t){return this._tags=t,this}},{key:"read",value:function(t){var e=this;this._mediaFileReader.init({onSuccess:function(){e._loadData(e._mediaFileReader,{onSuccess:function(){try{var n=e._parseData(e._mediaFileReader,e._tags)}catch(e){if(t.onError)return void t.onError({type:"parseData",info:e.message})}t.onSuccess(n)},onError:t.onError})},onError:t.onError})}},{key:"getShortcuts",value:function(){return{}}},{key:"_loadData",value:function(t,e){throw Error("Must implement _loadData function")}},{key:"_parseData",value:function(t,e){throw Error("Must implement _parseData function")}},{key:"_expandShortcutTags",value:function(t){if(!t)return null;for(var e,n=[],r=this.getShortcuts(),i=0;e=t[i];i++)n=n.concat(r[e]||[e]);return n}}],[{key:"getTagIdentifierByteRange",value:function(){throw Error("Must implement")}},{key:"canReadTagFormat",value:function(t){throw Error("Must implement")}}]),t}(),e.exports=t},{"./MediaFileReader":11}],13:[function(t,e,n){function r(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function i(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var a=function(){function t(e,n){if(!(this instanceof t))throw new TypeError("Cannot call a class as a function");i(this,"_value",void 0),i(this,"bytesReadCount",void 0),i(this,"length",void 0),this._value=e,this.bytesReadCount=n,this.length=e.length}return function(t,e,n){e&&r(t.prototype,e),n&&r(t,n)}(t,[{key:"toString",value:function(){return this._value}}]),t}();e.exports={readUTF16String:function(t,e,n){var r=0,i=1,o=0;n=Math.min(n||t.length,t.length),254==t[0]&&255==t[1]?(e=!0,r=2):255==t[0]&&254==t[1]&&(e=!1,r=2),e&&(i=0,o=1),e=[];for(var s=0;r<n;s++){var u=t[r+i],l=(u<<8)+t[r+o];if(r+=2,0==l)break;216>u||224<=u?e[s]=String.fromCharCode(l):(u=(t[r+i]<<8)+t[r+o],r+=2,e[s]=String.fromCharCode(l,u))}return new a(e.join(""),r)},readUTF8String:function(t,e){var n=0;e=Math.min(e||t.length,t.length),239==t[0]&&187==t[1]&&191==t[2]&&(n=3);for(var r=[],i=0;n<e;i++){var o=t[n++];if(0==o)break;if(128>o)r[i]=String.fromCharCode(o);else if(194<=o&&224>o){var s=t[n++];r[i]=String.fromCharCode(((31&o)<<6)+(63&s))}else if(224<=o&&240>o){s=t[n++];var u=t[n++];r[i]=String.fromCharCode(((255&o)<<12)+((63&s)<<6)+(63&u))}else 240<=o&&245>o&&(u=((7&o)<<18)+((63&(s=t[n++]))<<12)+((63&(u=t[n++]))<<6)+(63&t[n++])-65536,r[i]=String.fromCharCode(55296+(u>>10),56320+(1023&u)))}return new a(r.join(""),n)},readNullTerminatedString:function(t,e){var n=[];e=e||t.length;for(var r=0;r<e;){var i=t[r++];if(0==i)break;n[r-1]=String.fromCharCode(i)}return new a(n.join(""),r)}}},{}],14:[function(t,e,n){function r(t){return(r="function"==typeof Symbol&&"symbol"===l(Symbol.iterator)?function(t){return l(t)}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":l(t)})(t)}function i(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function a(t){return(a=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function o(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function s(t,e){return(s=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function u(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var c=t("./ChunkedFileData");n=function(e){function n(t){if(!(this instanceof n))throw new TypeError("Cannot call a class as a function");var e=a(n).call(this);return e=!e||"object"!==r(e)&&"function"!=typeof e?o(this):e,u(o(e),"_url",void 0),u(o(e),"_fileData",void 0),e._url=t,e._fileData=new c,e}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&s(t,e)}(n,e),function(t,e,n){e&&i(t.prototype,e),n&&i(t,n)}(n,[{key:"_init",value:function(t){n._config.avoidHeadRequests?this._fetchSizeWithGetRequest(t):this._fetchSizeWithHeadRequest(t)}},{key:"_fetchSizeWithHeadRequest",value:function(t){var e=this;this._makeXHRRequest("HEAD",null,{onSuccess:function(n){(n=e._parseContentLength(n))?(e._size=n,t.onSuccess()):e._fetchSizeWithGetRequest(t)},onError:t.onError})}},{key:"_fetchSizeWithGetRequest",value:function(t){var e=this,n=this._roundRangeToChunkMultiple([0,0]);this._makeXHRRequest("GET",n,{onSuccess:function(n){var r=e._parseContentRange(n);if(n=e._getXhrResponseContent(n),r){if(null==r.instanceLength)return void e._fetchEntireFile(t);e._size=r.instanceLength}else e._size=n.length;e._fileData.addData(0,n),t.onSuccess()},onError:t.onError})}},{key:"_fetchEntireFile",value:function(t){var e=this;this._makeXHRRequest("GET",null,{onSuccess:function(n){n=e._getXhrResponseContent(n),e._size=n.length,e._fileData.addData(0,n),t.onSuccess()},onError:t.onError})}},{key:"_getXhrResponseContent",value:function(t){return t.responseBody||t.responseText||""}},{key:"_parseContentLength",value:function(t){return null==(t=this._getResponseHeader(t,"Content-Length"))?t:parseInt(t,10)}},{key:"_parseContentRange",value:function(t){if(t=this._getResponseHeader(t,"Content-Range")){var e=t.match(/bytes (\d+)-(\d+)\/(?:(\d+)|\*)/i);if(!e)throw Error("FIXME: Unknown Content-Range syntax: "+t);return{firstBytePosition:parseInt(e[1],10),lastBytePosition:parseInt(e[2],10),instanceLength:e[3]?parseInt(e[3],10):null}}return null}},{key:"loadRange",value:function(t,e){var n=this;n._fileData.hasDataRange(t[0],Math.min(n._size,t[1]))?setTimeout(e.onSuccess,1):((t=this._roundRangeToChunkMultiple(t))[1]=Math.min(n._size,t[1]),this._makeXHRRequest("GET",t,{onSuccess:function(r){r=n._getXhrResponseContent(r),n._fileData.addData(t[0],r),e.onSuccess()},onError:e.onError}))}},{key:"_roundRangeToChunkMultiple",value:function(t){return[t[0],t[0]+1024*Math.ceil((t[1]-t[0]+1)/1024)-1]}},{key:"_makeXHRRequest",value:function(t,e,r){var i=this._createXHRObject();i.open(t,this._url);var a=function(){200===i.status||206===i.status?r.onSuccess(i):r.onError&&r.onError({type:"xhr",info:"Unexpected HTTP status "+i.status+".",xhr:i}),i=null};void 0!==i.onload?(i.onload=a,i.onerror=function(){r.onError&&r.onError({type:"xhr",info:"Generic XHR error, check xhr object.",xhr:i})}):i.onreadystatechange=function(){4===i.readyState&&a()},n._config.timeoutInSec&&(i.timeout=1e3*n._config.timeoutInSec,i.ontimeout=function(){r.onError&&r.onError({type:"xhr",info:"Timeout after "+i.timeout/1e3+"s. Use jsmediatags.Config.setXhrTimeout to override.",xhr:i})}),i.overrideMimeType("text/plain; charset=x-user-defined"),e&&this._setRequestHeader(i,"Range","bytes="+e[0]+"-"+e[1]),this._setRequestHeader(i,"If-Modified-Since","Sat, 01 Jan 1970 00:00:00 GMT"),i.send(null)}},{key:"_setRequestHeader",value:function(t,e,r){0>n._config.disallowedXhrHeaders.indexOf(e.toLowerCase())&&t.setRequestHeader(e,r)}},{key:"_hasResponseHeader",value:function(t,e){if(!(t=t.getAllResponseHeaders()))return!1;t=t.split("\r\n");for(var n=[],r=0;r<t.length;r++)n[r]=t[r].split(":")[0].toLowerCase();return 0<=n.indexOf(e.toLowerCase())}},{key:"_getResponseHeader",value:function(t,e){return this._hasResponseHeader(t,e)?t.getResponseHeader(e):null}},{key:"getByteAt",value:function(t){return 255&this._fileData.getByteAt(t).charCodeAt(0)}},{key:"_isWebWorker",value:function(){return"undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope}},{key:"_createXHRObject",value:function(){if("undefined"==typeof window&&!this._isWebWorker())return new(t("xhr2").XMLHttpRequest);if("undefined"!=typeof XMLHttpRequest)return new XMLHttpRequest;throw Error("XMLHttpRequest is not supported")}}],[{key:"canReadFile",value:function(t){return"string"==typeof t&&/^[a-z]+:\/\//i.test(t)}},{key:"setConfig",value:function(t){for(var e in t)t.hasOwnProperty(e)&&(this._config[e]=t[e]);for(t=this._config.disallowedXhrHeaders,e=0;e<t.length;e++)t[e]=t[e].toLowerCase()}}]),n}(t("./MediaFileReader")),u(n,"_config",void 0),n._config={avoidHeadRequests:!1,disallowedXhrHeaders:[],timeoutInSec:30},e.exports=n},{"./ChunkedFileData":5,"./MediaFileReader":11,xhr2:2}],15:[function(t,e,n){function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function a(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function o(t,e,n){return e&&a(t.prototype,e),n&&a(t,n),t}function s(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function u(t,e){var n=0>t.offset&&(-t.offset>e||0<t.offset+t.length);return!(0<=t.offset&&t.offset+t.length>=e||n)}t("./MediaFileReader");var l=t("./XhrFileReader"),c=t("./BlobFileReader"),f=t("./ArrayFileReader");t("./MediaTagReader");var h=t("./ID3v1TagReader"),d=t("./ID3v2TagReader"),p=t("./MP4TagReader"),y=t("./FLACTagReader"),g=[],m=[],v=function(){function t(e){r(this,t),s(this,"_file",void 0),s(this,"_tagsToRead",void 0),s(this,"_fileReader",void 0),s(this,"_tagReader",void 0),this._file=e}return o(t,[{key:"setTagsToRead",value:function(t){return this._tagsToRead=t,this}},{key:"setFileReader",value:function(t){return this._fileReader=t,this}},{key:"setTagReader",value:function(t){return this._tagReader=t,this}},{key:"read",value:function(t){var e=new(this._getFileReader())(this._file),n=this;e.init({onSuccess:function(){n._getTagReader(e,{onSuccess:function(r){new r(e).setTagsToRead(n._tagsToRead).read(t)},onError:t.onError})},onError:t.onError})}},{key:"_getFileReader",value:function(){return this._fileReader?this._fileReader:this._findFileReader()}},{key:"_findFileReader",value:function(){for(var t=0;t<g.length;t++)if(g[t].canReadFile(this._file))return g[t];throw Error("No suitable file reader found for "+this._file)}},{key:"_getTagReader",value:function(t,e){if(this._tagReader){var n=this._tagReader;setTimeout((function(){e.onSuccess(n)}),1)}else this._findTagReader(t,e)}},{key:"_findTagReader",value:function(t,e){for(var n=[],r=[],i=t.getSize(),a=0;a<m.length;a++){var o=m[a].getTagIdentifierByteRange();u(o,i)&&(0<=o.offset&&o.offset<i/2||0>o.offset&&o.offset<-i/2?n.push(m[a]):r.push(m[a]))}var s=!1;a={onSuccess:function(){if(s){for(var n=0;n<m.length;n++){var r=m[n].getTagIdentifierByteRange();if(u(r,i)){try{var a=t.getBytesAt(0<=r.offset?r.offset:r.offset+i,r.length)}catch(t){return void(e.onError&&e.onError({type:"fileReader",info:t.message}))}if(m[n].canReadTagFormat(a))return void e.onSuccess(m[n])}}e.onError&&e.onError({type:"tagFormat",info:"No suitable tag reader found"})}else s=!0},onError:e.onError},this._loadTagIdentifierRanges(t,n,a),this._loadTagIdentifierRanges(t,r,a)}},{key:"_loadTagIdentifierRanges",value:function(t,e,n){if(0===e.length)setTimeout(n.onSuccess,1);else{for(var r=[Number.MAX_VALUE,0],i=t.getSize(),a=0;a<e.length;a++){var o=e[a].getTagIdentifierByteRange(),s=0<=o.offset?o.offset:o.offset+i;o=s+o.length-1,r[0]=Math.min(s,r[0]),r[1]=Math.max(o,r[1])}t.loadRange(r,n)}}}]),t}();(n=function(){function t(){r(this,t)}return o(t,null,[{key:"addFileReader",value:function(e){return g.push(e),t}},{key:"addTagReader",value:function(e){return m.push(e),t}},{key:"removeTagReader",value:function(e){return 0<=(e=m.indexOf(e))&&m.splice(e,1),t}},{key:"EXPERIMENTAL_avoidHeadRequests",value:function(){l.setConfig({avoidHeadRequests:!0})}},{key:"setDisallowedXhrHeaders",value:function(t){l.setConfig({disallowedXhrHeaders:t})}},{key:"setXhrTimeoutInSec",value:function(t){l.setConfig({timeoutInSec:t})}}]),t}()).addFileReader(l).addFileReader(c).addFileReader(f).addTagReader(d).addTagReader(h).addTagReader(p).addTagReader(y),void 0===i||i.browser||(t="undefined"!=typeof navigator&&"ReactNative"===navigator.product?t("./ReactNativeFileReader"):t("./NodeFileReader"),n.addFileReader(t)),e.exports={read:function(t,e){new v(t).read(e)},Reader:v,Config:n}},{"./ArrayFileReader":3,"./BlobFileReader":4,"./FLACTagReader":6,"./ID3v1TagReader":7,"./ID3v2TagReader":9,"./MP4TagReader":10,"./MediaFileReader":11,"./MediaTagReader":12,"./NodeFileReader":1,"./ReactNativeFileReader":1,"./XhrFileReader":14}]},{},[15])(15)},"object"===l(e)&&void 0!==t?t.exports=c():(o=[],void 0===(s="function"==typeof(a=c)?a.apply(e,o):a)||(t.exports=s))}).call(this,n(1),n(5).Buffer,n(9))},function(t,e,n){"use strict";(function(t){var r=n(6),i=n(7),a=n(8);function o(){return u.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function s(t,e){if(o()<e)throw new RangeError("Invalid typed array length");return u.TYPED_ARRAY_SUPPORT?(t=new Uint8Array(e)).__proto__=u.prototype:(null===t&&(t=new u(e)),t.length=e),t}function u(t,e,n){if(!(u.TYPED_ARRAY_SUPPORT||this instanceof u))return new u(t,e,n);if("number"==typeof t){if("string"==typeof e)throw new Error("If encoding is specified then the first argument must be a string");return f(this,t)}return l(this,t,e,n)}function l(t,e,n,r){if("number"==typeof e)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&e instanceof ArrayBuffer?function(t,e,n,r){if(e.byteLength,n<0||e.byteLength<n)throw new RangeError("'offset' is out of bounds");if(e.byteLength<n+(r||0))throw new RangeError("'length' is out of bounds");e=void 0===n&&void 0===r?new Uint8Array(e):void 0===r?new Uint8Array(e,n):new Uint8Array(e,n,r);u.TYPED_ARRAY_SUPPORT?(t=e).__proto__=u.prototype:t=h(t,e);return t}(t,e,n,r):"string"==typeof e?function(t,e,n){"string"==typeof n&&""!==n||(n="utf8");if(!u.isEncoding(n))throw new TypeError('"encoding" must be a valid string encoding');var r=0|p(e,n),i=(t=s(t,r)).write(e,n);i!==r&&(t=t.slice(0,i));return t}(t,e,n):function(t,e){if(u.isBuffer(e)){var n=0|d(e.length);return 0===(t=s(t,n)).length?t:(e.copy(t,0,0,n),t)}if(e){if("undefined"!=typeof ArrayBuffer&&e.buffer instanceof ArrayBuffer||"length"in e)return"number"!=typeof e.length||(r=e.length)!=r?s(t,0):h(t,e);if("Buffer"===e.type&&a(e.data))return h(t,e.data)}var r;throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}(t,e)}function c(t){if("number"!=typeof t)throw new TypeError('"size" argument must be a number');if(t<0)throw new RangeError('"size" argument must not be negative')}function f(t,e){if(c(e),t=s(t,e<0?0:0|d(e)),!u.TYPED_ARRAY_SUPPORT)for(var n=0;n<e;++n)t[n]=0;return t}function h(t,e){var n=e.length<0?0:0|d(e.length);t=s(t,n);for(var r=0;r<n;r+=1)t[r]=255&e[r];return t}function d(t){if(t>=o())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+o().toString(16)+" bytes");return 0|t}function p(t,e){if(u.isBuffer(t))return t.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(t)||t instanceof ArrayBuffer))return t.byteLength;"string"!=typeof t&&(t=""+t);var n=t.length;if(0===n)return 0;for(var r=!1;;)switch(e){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":case void 0:return z(t).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return Y(t).length;default:if(r)return z(t).length;e=(""+e).toLowerCase(),r=!0}}function y(t,e,n){var r=!1;if((void 0===e||e<0)&&(e=0),e>this.length)return"";if((void 0===n||n>this.length)&&(n=this.length),n<=0)return"";if((n>>>=0)<=(e>>>=0))return"";for(t||(t="utf8");;)switch(t){case"hex":return O(this,e,n);case"utf8":case"utf-8":return E(this,e,n);case"ascii":return C(this,e,n);case"latin1":case"binary":return P(this,e,n);case"base64":return R(this,e,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return L(this,e,n);default:if(r)throw new TypeError("Unknown encoding: "+t);t=(t+"").toLowerCase(),r=!0}}function g(t,e,n){var r=t[e];t[e]=t[n],t[n]=r}function m(t,e,n,r,i){if(0===t.length)return-1;if("string"==typeof n?(r=n,n=0):n>2147483647?n=2147483647:n<-2147483648&&(n=-2147483648),n=+n,isNaN(n)&&(n=i?0:t.length-1),n<0&&(n=t.length+n),n>=t.length){if(i)return-1;n=t.length-1}else if(n<0){if(!i)return-1;n=0}if("string"==typeof e&&(e=u.from(e,r)),u.isBuffer(e))return 0===e.length?-1:v(t,e,n,r,i);if("number"==typeof e)return e&=255,u.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?i?Uint8Array.prototype.indexOf.call(t,e,n):Uint8Array.prototype.lastIndexOf.call(t,e,n):v(t,[e],n,r,i);throw new TypeError("val must be string, number or Buffer")}function v(t,e,n,r,i){var a,o=1,s=t.length,u=e.length;if(void 0!==r&&("ucs2"===(r=String(r).toLowerCase())||"ucs-2"===r||"utf16le"===r||"utf-16le"===r)){if(t.length<2||e.length<2)return-1;o=2,s/=2,u/=2,n/=2}function l(t,e){return 1===o?t[e]:t.readUInt16BE(e*o)}if(i){var c=-1;for(a=n;a<s;a++)if(l(t,a)===l(e,-1===c?0:a-c)){if(-1===c&&(c=a),a-c+1===u)return c*o}else-1!==c&&(a-=a-c),c=-1}else for(n+u>s&&(n=s-u),a=n;a>=0;a--){for(var f=!0,h=0;h<u;h++)if(l(t,a+h)!==l(e,h)){f=!1;break}if(f)return a}return-1}function _(t,e,n,r){n=Number(n)||0;var i=t.length-n;r?(r=Number(r))>i&&(r=i):r=i;var a=e.length;if(a%2!=0)throw new TypeError("Invalid hex string");r>a/2&&(r=a/2);for(var o=0;o<r;++o){var s=parseInt(e.substr(2*o,2),16);if(isNaN(s))return o;t[n+o]=s}return o}function b(t,e,n,r){return H(z(e,t.length-n),t,n,r)}function T(t,e,n,r){return H(function(t){for(var e=[],n=0;n<t.length;++n)e.push(255&t.charCodeAt(n));return e}(e),t,n,r)}function w(t,e,n,r){return T(t,e,n,r)}function k(t,e,n,r){return H(Y(e),t,n,r)}function S(t,e,n,r){return H(function(t,e){for(var n,r,i,a=[],o=0;o<t.length&&!((e-=2)<0);++o)n=t.charCodeAt(o),r=n>>8,i=n%256,a.push(i),a.push(r);return a}(e,t.length-n),t,n,r)}function R(t,e,n){return 0===e&&n===t.length?r.fromByteArray(t):r.fromByteArray(t.slice(e,n))}function E(t,e,n){n=Math.min(t.length,n);for(var r=[],i=e;i<n;){var a,o,s,u,l=t[i],c=null,f=l>239?4:l>223?3:l>191?2:1;if(i+f<=n)switch(f){case 1:l<128&&(c=l);break;case 2:128==(192&(a=t[i+1]))&&(u=(31&l)<<6|63&a)>127&&(c=u);break;case 3:a=t[i+1],o=t[i+2],128==(192&a)&&128==(192&o)&&(u=(15&l)<<12|(63&a)<<6|63&o)>2047&&(u<55296||u>57343)&&(c=u);break;case 4:a=t[i+1],o=t[i+2],s=t[i+3],128==(192&a)&&128==(192&o)&&128==(192&s)&&(u=(15&l)<<18|(63&a)<<12|(63&o)<<6|63&s)>65535&&u<1114112&&(c=u)}null===c?(c=65533,f=1):c>65535&&(c-=65536,r.push(c>>>10&1023|55296),c=56320|1023&c),r.push(c),i+=f}return function(t){var e=t.length;if(e<=A)return String.fromCharCode.apply(String,t);var n="",r=0;for(;r<e;)n+=String.fromCharCode.apply(String,t.slice(r,r+=A));return n}(r)}e.Buffer=u,e.SlowBuffer=function(t){+t!=t&&(t=0);return u.alloc(+t)},e.INSPECT_MAX_BYTES=50,u.TYPED_ARRAY_SUPPORT=void 0!==t.TYPED_ARRAY_SUPPORT?t.TYPED_ARRAY_SUPPORT:function(){try{var t=new Uint8Array(1);return t.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===t.foo()&&"function"==typeof t.subarray&&0===t.subarray(1,1).byteLength}catch(t){return!1}}(),e.kMaxLength=o(),u.poolSize=8192,u._augment=function(t){return t.__proto__=u.prototype,t},u.from=function(t,e,n){return l(null,t,e,n)},u.TYPED_ARRAY_SUPPORT&&(u.prototype.__proto__=Uint8Array.prototype,u.__proto__=Uint8Array,"undefined"!=typeof Symbol&&Symbol.species&&u[Symbol.species]===u&&Object.defineProperty(u,Symbol.species,{value:null,configurable:!0})),u.alloc=function(t,e,n){return function(t,e,n,r){return c(e),e<=0?s(t,e):void 0!==n?"string"==typeof r?s(t,e).fill(n,r):s(t,e).fill(n):s(t,e)}(null,t,e,n)},u.allocUnsafe=function(t){return f(null,t)},u.allocUnsafeSlow=function(t){return f(null,t)},u.isBuffer=function(t){return!(null==t||!t._isBuffer)},u.compare=function(t,e){if(!u.isBuffer(t)||!u.isBuffer(e))throw new TypeError("Arguments must be Buffers");if(t===e)return 0;for(var n=t.length,r=e.length,i=0,a=Math.min(n,r);i<a;++i)if(t[i]!==e[i]){n=t[i],r=e[i];break}return n<r?-1:r<n?1:0},u.isEncoding=function(t){switch(String(t).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},u.concat=function(t,e){if(!a(t))throw new TypeError('"list" argument must be an Array of Buffers');if(0===t.length)return u.alloc(0);var n;if(void 0===e)for(e=0,n=0;n<t.length;++n)e+=t[n].length;var r=u.allocUnsafe(e),i=0;for(n=0;n<t.length;++n){var o=t[n];if(!u.isBuffer(o))throw new TypeError('"list" argument must be an Array of Buffers');o.copy(r,i),i+=o.length}return r},u.byteLength=p,u.prototype._isBuffer=!0,u.prototype.swap16=function(){var t=this.length;if(t%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var e=0;e<t;e+=2)g(this,e,e+1);return this},u.prototype.swap32=function(){var t=this.length;if(t%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var e=0;e<t;e+=4)g(this,e,e+3),g(this,e+1,e+2);return this},u.prototype.swap64=function(){var t=this.length;if(t%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var e=0;e<t;e+=8)g(this,e,e+7),g(this,e+1,e+6),g(this,e+2,e+5),g(this,e+3,e+4);return this},u.prototype.toString=function(){var t=0|this.length;return 0===t?"":0===arguments.length?E(this,0,t):y.apply(this,arguments)},u.prototype.equals=function(t){if(!u.isBuffer(t))throw new TypeError("Argument must be a Buffer");return this===t||0===u.compare(this,t)},u.prototype.inspect=function(){var t="",n=e.INSPECT_MAX_BYTES;return this.length>0&&(t=this.toString("hex",0,n).match(/.{2}/g).join(" "),this.length>n&&(t+=" ... ")),"<Buffer "+t+">"},u.prototype.compare=function(t,e,n,r,i){if(!u.isBuffer(t))throw new TypeError("Argument must be a Buffer");if(void 0===e&&(e=0),void 0===n&&(n=t?t.length:0),void 0===r&&(r=0),void 0===i&&(i=this.length),e<0||n>t.length||r<0||i>this.length)throw new RangeError("out of range index");if(r>=i&&e>=n)return 0;if(r>=i)return-1;if(e>=n)return 1;if(this===t)return 0;for(var a=(i>>>=0)-(r>>>=0),o=(n>>>=0)-(e>>>=0),s=Math.min(a,o),l=this.slice(r,i),c=t.slice(e,n),f=0;f<s;++f)if(l[f]!==c[f]){a=l[f],o=c[f];break}return a<o?-1:o<a?1:0},u.prototype.includes=function(t,e,n){return-1!==this.indexOf(t,e,n)},u.prototype.indexOf=function(t,e,n){return m(this,t,e,n,!0)},u.prototype.lastIndexOf=function(t,e,n){return m(this,t,e,n,!1)},u.prototype.write=function(t,e,n,r){if(void 0===e)r="utf8",n=this.length,e=0;else if(void 0===n&&"string"==typeof e)r=e,n=this.length,e=0;else{if(!isFinite(e))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");e|=0,isFinite(n)?(n|=0,void 0===r&&(r="utf8")):(r=n,n=void 0)}var i=this.length-e;if((void 0===n||n>i)&&(n=i),t.length>0&&(n<0||e<0)||e>this.length)throw new RangeError("Attempt to write outside buffer bounds");r||(r="utf8");for(var a=!1;;)switch(r){case"hex":return _(this,t,e,n);case"utf8":case"utf-8":return b(this,t,e,n);case"ascii":return T(this,t,e,n);case"latin1":case"binary":return w(this,t,e,n);case"base64":return k(this,t,e,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return S(this,t,e,n);default:if(a)throw new TypeError("Unknown encoding: "+r);r=(""+r).toLowerCase(),a=!0}},u.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var A=4096;function C(t,e,n){var r="";n=Math.min(t.length,n);for(var i=e;i<n;++i)r+=String.fromCharCode(127&t[i]);return r}function P(t,e,n){var r="";n=Math.min(t.length,n);for(var i=e;i<n;++i)r+=String.fromCharCode(t[i]);return r}function O(t,e,n){var r=t.length;(!e||e<0)&&(e=0),(!n||n<0||n>r)&&(n=r);for(var i="",a=e;a<n;++a)i+=N(t[a]);return i}function L(t,e,n){for(var r=t.slice(e,n),i="",a=0;a<r.length;a+=2)i+=String.fromCharCode(r[a]+256*r[a+1]);return i}function I(t,e,n){if(t%1!=0||t<0)throw new RangeError("offset is not uint");if(t+e>n)throw new RangeError("Trying to access beyond buffer length")}function B(t,e,n,r,i,a){if(!u.isBuffer(t))throw new TypeError('"buffer" argument must be a Buffer instance');if(e>i||e<a)throw new RangeError('"value" argument is out of bounds');if(n+r>t.length)throw new RangeError("Index out of range")}function x(t,e,n,r){e<0&&(e=65535+e+1);for(var i=0,a=Math.min(t.length-n,2);i<a;++i)t[n+i]=(e&255<<8*(r?i:1-i))>>>8*(r?i:1-i)}function D(t,e,n,r){e<0&&(e=4294967295+e+1);for(var i=0,a=Math.min(t.length-n,4);i<a;++i)t[n+i]=e>>>8*(r?i:3-i)&255}function M(t,e,n,r,i,a){if(n+r>t.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("Index out of range")}function F(t,e,n,r,a){return a||M(t,0,n,4),i.write(t,e,n,r,23,4),n+4}function j(t,e,n,r,a){return a||M(t,0,n,8),i.write(t,e,n,r,52,8),n+8}u.prototype.slice=function(t,e){var n,r=this.length;if((t=~~t)<0?(t+=r)<0&&(t=0):t>r&&(t=r),(e=void 0===e?r:~~e)<0?(e+=r)<0&&(e=0):e>r&&(e=r),e<t&&(e=t),u.TYPED_ARRAY_SUPPORT)(n=this.subarray(t,e)).__proto__=u.prototype;else{var i=e-t;n=new u(i,void 0);for(var a=0;a<i;++a)n[a]=this[a+t]}return n},u.prototype.readUIntLE=function(t,e,n){t|=0,e|=0,n||I(t,e,this.length);for(var r=this[t],i=1,a=0;++a<e&&(i*=256);)r+=this[t+a]*i;return r},u.prototype.readUIntBE=function(t,e,n){t|=0,e|=0,n||I(t,e,this.length);for(var r=this[t+--e],i=1;e>0&&(i*=256);)r+=this[t+--e]*i;return r},u.prototype.readUInt8=function(t,e){return e||I(t,1,this.length),this[t]},u.prototype.readUInt16LE=function(t,e){return e||I(t,2,this.length),this[t]|this[t+1]<<8},u.prototype.readUInt16BE=function(t,e){return e||I(t,2,this.length),this[t]<<8|this[t+1]},u.prototype.readUInt32LE=function(t,e){return e||I(t,4,this.length),(this[t]|this[t+1]<<8|this[t+2]<<16)+16777216*this[t+3]},u.prototype.readUInt32BE=function(t,e){return e||I(t,4,this.length),16777216*this[t]+(this[t+1]<<16|this[t+2]<<8|this[t+3])},u.prototype.readIntLE=function(t,e,n){t|=0,e|=0,n||I(t,e,this.length);for(var r=this[t],i=1,a=0;++a<e&&(i*=256);)r+=this[t+a]*i;return r>=(i*=128)&&(r-=Math.pow(2,8*e)),r},u.prototype.readIntBE=function(t,e,n){t|=0,e|=0,n||I(t,e,this.length);for(var r=e,i=1,a=this[t+--r];r>0&&(i*=256);)a+=this[t+--r]*i;return a>=(i*=128)&&(a-=Math.pow(2,8*e)),a},u.prototype.readInt8=function(t,e){return e||I(t,1,this.length),128&this[t]?-1*(255-this[t]+1):this[t]},u.prototype.readInt16LE=function(t,e){e||I(t,2,this.length);var n=this[t]|this[t+1]<<8;return 32768&n?4294901760|n:n},u.prototype.readInt16BE=function(t,e){e||I(t,2,this.length);var n=this[t+1]|this[t]<<8;return 32768&n?4294901760|n:n},u.prototype.readInt32LE=function(t,e){return e||I(t,4,this.length),this[t]|this[t+1]<<8|this[t+2]<<16|this[t+3]<<24},u.prototype.readInt32BE=function(t,e){return e||I(t,4,this.length),this[t]<<24|this[t+1]<<16|this[t+2]<<8|this[t+3]},u.prototype.readFloatLE=function(t,e){return e||I(t,4,this.length),i.read(this,t,!0,23,4)},u.prototype.readFloatBE=function(t,e){return e||I(t,4,this.length),i.read(this,t,!1,23,4)},u.prototype.readDoubleLE=function(t,e){return e||I(t,8,this.length),i.read(this,t,!0,52,8)},u.prototype.readDoubleBE=function(t,e){return e||I(t,8,this.length),i.read(this,t,!1,52,8)},u.prototype.writeUIntLE=function(t,e,n,r){(t=+t,e|=0,n|=0,r)||B(this,t,e,n,Math.pow(2,8*n)-1,0);var i=1,a=0;for(this[e]=255&t;++a<n&&(i*=256);)this[e+a]=t/i&255;return e+n},u.prototype.writeUIntBE=function(t,e,n,r){(t=+t,e|=0,n|=0,r)||B(this,t,e,n,Math.pow(2,8*n)-1,0);var i=n-1,a=1;for(this[e+i]=255&t;--i>=0&&(a*=256);)this[e+i]=t/a&255;return e+n},u.prototype.writeUInt8=function(t,e,n){return t=+t,e|=0,n||B(this,t,e,1,255,0),u.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),this[e]=255&t,e+1},u.prototype.writeUInt16LE=function(t,e,n){return t=+t,e|=0,n||B(this,t,e,2,65535,0),u.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8):x(this,t,e,!0),e+2},u.prototype.writeUInt16BE=function(t,e,n){return t=+t,e|=0,n||B(this,t,e,2,65535,0),u.TYPED_ARRAY_SUPPORT?(this[e]=t>>>8,this[e+1]=255&t):x(this,t,e,!1),e+2},u.prototype.writeUInt32LE=function(t,e,n){return t=+t,e|=0,n||B(this,t,e,4,4294967295,0),u.TYPED_ARRAY_SUPPORT?(this[e+3]=t>>>24,this[e+2]=t>>>16,this[e+1]=t>>>8,this[e]=255&t):D(this,t,e,!0),e+4},u.prototype.writeUInt32BE=function(t,e,n){return t=+t,e|=0,n||B(this,t,e,4,4294967295,0),u.TYPED_ARRAY_SUPPORT?(this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t):D(this,t,e,!1),e+4},u.prototype.writeIntLE=function(t,e,n,r){if(t=+t,e|=0,!r){var i=Math.pow(2,8*n-1);B(this,t,e,n,i-1,-i)}var a=0,o=1,s=0;for(this[e]=255&t;++a<n&&(o*=256);)t<0&&0===s&&0!==this[e+a-1]&&(s=1),this[e+a]=(t/o>>0)-s&255;return e+n},u.prototype.writeIntBE=function(t,e,n,r){if(t=+t,e|=0,!r){var i=Math.pow(2,8*n-1);B(this,t,e,n,i-1,-i)}var a=n-1,o=1,s=0;for(this[e+a]=255&t;--a>=0&&(o*=256);)t<0&&0===s&&0!==this[e+a+1]&&(s=1),this[e+a]=(t/o>>0)-s&255;return e+n},u.prototype.writeInt8=function(t,e,n){return t=+t,e|=0,n||B(this,t,e,1,127,-128),u.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),t<0&&(t=255+t+1),this[e]=255&t,e+1},u.prototype.writeInt16LE=function(t,e,n){return t=+t,e|=0,n||B(this,t,e,2,32767,-32768),u.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8):x(this,t,e,!0),e+2},u.prototype.writeInt16BE=function(t,e,n){return t=+t,e|=0,n||B(this,t,e,2,32767,-32768),u.TYPED_ARRAY_SUPPORT?(this[e]=t>>>8,this[e+1]=255&t):x(this,t,e,!1),e+2},u.prototype.writeInt32LE=function(t,e,n){return t=+t,e|=0,n||B(this,t,e,4,2147483647,-2147483648),u.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8,this[e+2]=t>>>16,this[e+3]=t>>>24):D(this,t,e,!0),e+4},u.prototype.writeInt32BE=function(t,e,n){return t=+t,e|=0,n||B(this,t,e,4,2147483647,-2147483648),t<0&&(t=4294967295+t+1),u.TYPED_ARRAY_SUPPORT?(this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t):D(this,t,e,!1),e+4},u.prototype.writeFloatLE=function(t,e,n){return F(this,t,e,!0,n)},u.prototype.writeFloatBE=function(t,e,n){return F(this,t,e,!1,n)},u.prototype.writeDoubleLE=function(t,e,n){return j(this,t,e,!0,n)},u.prototype.writeDoubleBE=function(t,e,n){return j(this,t,e,!1,n)},u.prototype.copy=function(t,e,n,r){if(n||(n=0),r||0===r||(r=this.length),e>=t.length&&(e=t.length),e||(e=0),r>0&&r<n&&(r=n),r===n)return 0;if(0===t.length||0===this.length)return 0;if(e<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("sourceStart out of bounds");if(r<0)throw new RangeError("sourceEnd out of bounds");r>this.length&&(r=this.length),t.length-e<r-n&&(r=t.length-e+n);var i,a=r-n;if(this===t&&n<e&&e<r)for(i=a-1;i>=0;--i)t[i+e]=this[i+n];else if(a<1e3||!u.TYPED_ARRAY_SUPPORT)for(i=0;i<a;++i)t[i+e]=this[i+n];else Uint8Array.prototype.set.call(t,this.subarray(n,n+a),e);return a},u.prototype.fill=function(t,e,n,r){if("string"==typeof t){if("string"==typeof e?(r=e,e=0,n=this.length):"string"==typeof n&&(r=n,n=this.length),1===t.length){var i=t.charCodeAt(0);i<256&&(t=i)}if(void 0!==r&&"string"!=typeof r)throw new TypeError("encoding must be a string");if("string"==typeof r&&!u.isEncoding(r))throw new TypeError("Unknown encoding: "+r)}else"number"==typeof t&&(t&=255);if(e<0||this.length<e||this.length<n)throw new RangeError("Out of range index");if(n<=e)return this;var a;if(e>>>=0,n=void 0===n?this.length:n>>>0,t||(t=0),"number"==typeof t)for(a=e;a<n;++a)this[a]=t;else{var o=u.isBuffer(t)?t:z(new u(t,r).toString()),s=o.length;for(a=0;a<n-e;++a)this[a+e]=o[a%s]}return this};var U=/[^+\/0-9A-Za-z-_]/g;function N(t){return t<16?"0"+t.toString(16):t.toString(16)}function z(t,e){var n;e=e||1/0;for(var r=t.length,i=null,a=[],o=0;o<r;++o){if((n=t.charCodeAt(o))>55295&&n<57344){if(!i){if(n>56319){(e-=3)>-1&&a.push(239,191,189);continue}if(o+1===r){(e-=3)>-1&&a.push(239,191,189);continue}i=n;continue}if(n<56320){(e-=3)>-1&&a.push(239,191,189),i=n;continue}n=65536+(i-55296<<10|n-56320)}else i&&(e-=3)>-1&&a.push(239,191,189);if(i=null,n<128){if((e-=1)<0)break;a.push(n)}else if(n<2048){if((e-=2)<0)break;a.push(n>>6|192,63&n|128)}else if(n<65536){if((e-=3)<0)break;a.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(n<1114112))throw new Error("Invalid code point");if((e-=4)<0)break;a.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return a}function Y(t){return r.toByteArray(function(t){if((t=function(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")}(t).replace(U,"")).length<2)return"";for(;t.length%4!=0;)t+="=";return t}(t))}function H(t,e,n,r){for(var i=0;i<r&&!(i+n>=e.length||i>=t.length);++i)e[i+n]=t[i];return i}}).call(this,n(1))},function(t,e,n){"use strict";e.byteLength=function(t){var e=l(t),n=e[0],r=e[1];return 3*(n+r)/4-r},e.toByteArray=function(t){var e,n,r=l(t),o=r[0],s=r[1],u=new a(function(t,e,n){return 3*(e+n)/4-n}(0,o,s)),c=0,f=s>0?o-4:o;for(n=0;n<f;n+=4)e=i[t.charCodeAt(n)]<<18|i[t.charCodeAt(n+1)]<<12|i[t.charCodeAt(n+2)]<<6|i[t.charCodeAt(n+3)],u[c++]=e>>16&255,u[c++]=e>>8&255,u[c++]=255&e;2===s&&(e=i[t.charCodeAt(n)]<<2|i[t.charCodeAt(n+1)]>>4,u[c++]=255&e);1===s&&(e=i[t.charCodeAt(n)]<<10|i[t.charCodeAt(n+1)]<<4|i[t.charCodeAt(n+2)]>>2,u[c++]=e>>8&255,u[c++]=255&e);return u},e.fromByteArray=function(t){for(var e,n=t.length,i=n%3,a=[],o=0,s=n-i;o<s;o+=16383)a.push(c(t,o,o+16383>s?s:o+16383));1===i?(e=t[n-1],a.push(r[e>>2]+r[e<<4&63]+"==")):2===i&&(e=(t[n-2]<<8)+t[n-1],a.push(r[e>>10]+r[e>>4&63]+r[e<<2&63]+"="));return a.join("")};for(var r=[],i=[],a="undefined"!=typeof Uint8Array?Uint8Array:Array,o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",s=0,u=o.length;s<u;++s)r[s]=o[s],i[o.charCodeAt(s)]=s;function l(t){var e=t.length;if(e%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var n=t.indexOf("=");return-1===n&&(n=e),[n,n===e?0:4-n%4]}function c(t,e,n){for(var i,a,o=[],s=e;s<n;s+=3)i=(t[s]<<16&16711680)+(t[s+1]<<8&65280)+(255&t[s+2]),o.push(r[(a=i)>>18&63]+r[a>>12&63]+r[a>>6&63]+r[63&a]);return o.join("")}i["-".charCodeAt(0)]=62,i["_".charCodeAt(0)]=63},function(t,e){e.read=function(t,e,n,r,i){var a,o,s=8*i-r-1,u=(1<<s)-1,l=u>>1,c=-7,f=n?i-1:0,h=n?-1:1,d=t[e+f];for(f+=h,a=d&(1<<-c)-1,d>>=-c,c+=s;c>0;a=256*a+t[e+f],f+=h,c-=8);for(o=a&(1<<-c)-1,a>>=-c,c+=r;c>0;o=256*o+t[e+f],f+=h,c-=8);if(0===a)a=1-l;else{if(a===u)return o?NaN:1/0*(d?-1:1);o+=Math.pow(2,r),a-=l}return(d?-1:1)*o*Math.pow(2,a-r)},e.write=function(t,e,n,r,i,a){var o,s,u,l=8*a-i-1,c=(1<<l)-1,f=c>>1,h=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,d=r?0:a-1,p=r?1:-1,y=e<0||0===e&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(s=isNaN(e)?1:0,o=c):(o=Math.floor(Math.log(e)/Math.LN2),e*(u=Math.pow(2,-o))<1&&(o--,u*=2),(e+=o+f>=1?h/u:h*Math.pow(2,1-f))*u>=2&&(o++,u/=2),o+f>=c?(s=0,o=c):o+f>=1?(s=(e*u-1)*Math.pow(2,i),o+=f):(s=e*Math.pow(2,f-1)*Math.pow(2,i),o=0));i>=8;t[n+d]=255&s,d+=p,s/=256,i-=8);for(o=o<<i|s,l+=i;l>0;t[n+d]=255&o,d+=p,o/=256,l-=8);t[n+d-p]|=128*y}},function(t,e){var n={}.toString;t.exports=Array.isArray||function(t){return"[object Array]"==n.call(t)}},function(t,e){var n,r,i=t.exports={};function a(){throw new Error("setTimeout has not been defined")}function o(){throw new Error("clearTimeout has not been defined")}function s(t){if(n===setTimeout)return setTimeout(t,0);if((n===a||!n)&&setTimeout)return n=setTimeout,setTimeout(t,0);try{return n(t,0)}catch(e){try{return n.call(null,t,0)}catch(e){return n.call(this,t,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:a}catch(t){n=a}try{r="function"==typeof clearTimeout?clearTimeout:o}catch(t){r=o}}();var u,l=[],c=!1,f=-1;function h(){c&&u&&(c=!1,u.length?l=u.concat(l):f=-1,l.length&&d())}function d(){if(!c){var t=s(h);c=!0;for(var e=l.length;e;){for(u=l,l=[];++f<e;)u&&u[f].run();f=-1,e=l.length}u=null,c=!1,function(t){if(r===clearTimeout)return clearTimeout(t);if((r===o||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(t);try{r(t)}catch(e){try{return r.call(null,t)}catch(e){return r.call(this,t)}}}(t)}}function p(t,e){this.fun=t,this.array=e}function y(){}i.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];l.push(new p(t,e)),1!==l.length||c||s(d)},p.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=y,i.addListener=y,i.once=y,i.off=y,i.removeListener=y,i.removeAllListeners=y,i.emit=y,i.prependListener=y,i.prependOnceListener=y,i.listeners=function(t){return[]},i.binding=function(t){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(t){throw new Error("process.chdir is not supported")},i.umask=function(){return 0}},function(t,e,n){"use strict";n.r(e);var r=n(0),i=n.n(r);function a(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var o=function(){function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._calamansi=e,this.audio=new Audio,this.load(n),this.duration=0,this.loadedPercent=0,this.currentTime=0,this.volume=this.audio.volume,this.playbackRate=1,this._addEventListeners()}var e,n,r;return e=t,(n=[{key:"_addEventListeners",value:function(){var t=this;this.audio.addEventListener("loadedmetadata",(function(e){t.duration=t.audio.duration,t._calamansi.currentTrack().info.duration=t.audio.duration,t._calamansi._emit("loadedmetadata",t._calamansi),CalamansiEvents._emit("loadedmetadata",t._calamansi)})),this.audio.addEventListener("loadeddata",(function(e){t._setCurrentTime(t.audio.currentTime),t._calamansi._emit("loadeddata",t._calamansi),CalamansiEvents._emit("loadeddata",t._calamansi)})),this.audio.addEventListener("progress",(function(t,e){})),this.audio.addEventListener("canplaythrough",(function(e){t.loadedPercent=100,t._calamansi._emit("canplaythrough",t._calamansi),CalamansiEvents._emit("canplaythrough",t._calamansi),t._calamansi._emit("loadingProgress",t._calamansi),CalamansiEvents._emit("loadingProgress",t._calamansi)})),this.audio.addEventListener("timeupdate",(function(e){t._setCurrentTime(t.audio.currentTime)})),this.audio.addEventListener("ended",(function(e){t._setCurrentTime(0),t._calamansi._emit("trackEnded",t._calamansi),CalamansiEvents._emit("trackEnded",t._calamansi)}))}},{key:"load",value:function(t){this.stop(),t.startsWith("https://api.soundcloud.com")&&(t.endsWith("/")&&(t=t.substring(0,t.length-1)),this._calamansi._options.soundcloudClientId||console.error("Please set your SoundCloud client id in the soundcloudClientId option to play SoundCloud tracks."),t+="/stream?client_id="+this._calamansi._options.soundcloudClientId),this.audio.src=t,this.audio.load()}},{key:"playFromStart",value:function(){this.audio.pause(),this.audio.currentTime=0,this.currentTime=0,this.audio.play(),this._calamansi._emit("play",this._calamansi),CalamansiEvents._emit("play",this._calamansi)}},{key:"play",value:function(){this.audio.play(),this._calamansi._emit("play",this._calamansi),CalamansiEvents._emit("play",this._calamansi)}},{key:"pause",value:function(){this.audio.pause(),this._calamansi._emit("pause",this._calamansi),CalamansiEvents._emit("pause",this._calamansi)}},{key:"stop",value:function(){this.audio.pause(),this.audio.currentTime=0,this.currentTime=0,this._calamansi._emit("stop",this._calamansi),CalamansiEvents._emit("stop",this._calamansi)}},{key:"unload",value:function(){this.audio.pause(),this.audio.removeAttribute("src"),this.audio.load()}},{key:"_setCurrentTime",value:function(t){this.currentTime=t,this._calamansi._emit("timeupdate",this._calamansi),CalamansiEvents._emit("timeupdate",this._calamansi)}},{key:"seekTo",value:function(t){this.audio.currentTime=t,this._setCurrentTime(t)}},{key:"changeVolume",value:function(t){t=(t=t>=0?t:0)<=1?t:1,this.audio.volume=t,this.volume=t,this._calamansi._emit("volumechange",this._calamansi),CalamansiEvents._emit("volumechange",this._calamansi)}},{key:"changePlaybackRate",value:function(t){this.playbackRate=t,this.audio.playbackRate=t,this._calamansi._emit("ratechange",this._calamansi),CalamansiEvents._emit("ratechange",this._calamansi)}}])&&a(e.prototype,n),r&&a(e,r),t}();function s(t,e,n,r,i,a,o){try{var s=t[a](o),u=s.value}catch(t){return void n(t)}s.done?e(u):Promise.resolve(u).then(r,i)}function u(t){return function(){var e=this,n=arguments;return new Promise((function(r,i){var a=t.apply(e,n);function o(t){s(a,r,i,o,u,"next",t)}function u(t){s(a,r,i,o,u,"throw",t)}o(void 0)}))}}function l(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var c=function(){function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.calamansi=e,this.path=n,this.content="",this.el=e.el,this.mouseDownTarget=null}var e,n,r,a,o,s;return e=t,(n=[{key:"init",value:(s=u(i.a.mark((function t(){return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.load();case 2:this.content=t.sent,this.setUiElements(),this.activateControls(),this.addEventListeners();case 6:case"end":return t.stop()}}),t,this)}))),function(){return s.apply(this,arguments)})},{key:"load",value:(o=u(i.a.mark((function t(){var e,n,r;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this.loadCss(this.path),t.next=3,this.fetchHtml(this.path);case 3:return e=t.sent,n=this.el.innerHTML,(r=document.createElement("div")).innerHTML=e.trim(),r.firstChild.dataset.noWrapper&&delete(r=r.firstChild).dataset.noWrapper,r.classList.add("calamansi"),r.id=this.calamansi.id,this.el.parentNode.replaceChild(r,this.el),this.el=r,t.next=14,this.loadJs(this.path);case 14:return t.abrupt("return",n);case 15:case"end":return t.stop()}}),t,this)}))),function(){return o.apply(this,arguments)})},{key:"loadCss",value:function(t){var e="".concat(t,"/skin.css");if(!(document.querySelectorAll('link[href="'.concat(e,'"]')).length>0)){var n=document.createElement("link");n.rel="stylesheet",n.href=e,document.querySelector("head").appendChild(n)}}},{key:"loadJs",value:function(t){var e=this;return new Promise((function(n,r){var i="".concat(t,"/skin.js"),a=document.querySelectorAll('script[src="'.concat(i,'"]'));a.length>0&&a[0].dataset.loaded?n():a.length>0?setTimeout((function(){n(e.loadJs(t))}),100):((a=document.createElement("script")).onload=function(){a.dataset.loaded="1",n()},a.setAttribute("src",i),document.querySelector("head").appendChild(a))}))}},{key:"fetchHtml",value:(a=u(i.a.mark((function t(e){return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",fetch("".concat(e,"/skin.html")).then((function(t){if(200!=t.status)throw'Skin at path "'.concat(e,'" not found!');return t.text()})).then((function(t){for(t=t.trim();t.search("\n")>=0;)t=t.replace(/\n/,"");for(;t.search("  ")>=0;)t=t.replace(/  /,"");return t})));case 1:case"end":return t.stop()}}),t)}))),function(t){return a.apply(this,arguments)})},{key:"setUiElements",value:function(){var t=this,e=document.querySelectorAll("#".concat(this.el.id," .clmns--slot--content"));e&&e.length>0&&e.forEach((function(e){e.innerHTML=t.content})),this.updateCheckboxes(),this.updatePlaylistList(),this.updatePlaylist(),this.updateTrackInfo()}},{key:"activateControls",value:function(){var t=this;this.el.addEventListener("mousedown",(function(e){t.mouseDownTarget=e.target})),document.addEventListener("mouseup",(function(e){t.mouseDownTarget=null})),this.el.addEventListener("touchstart",(function(e){t.mouseDownTarget=e.target})),document.addEventListener("touchend",(function(e){t.mouseDownTarget=null})),this.el.addEventListener("click",(function(e){if("checkbox"===e.target.type||e.target.classList.contains("clmns--link")||e.preventDefault(),t.calamansi.audio)if(t.containsClass(e.target,"clmns--control-play"))t.calamansi.audio.playFromStart();else if(t.containsClass(e.target,"clmns--control-resume"))t.calamansi.audio.play();else if(t.containsClass(e.target,"clmns--control-pause"))t.calamansi.audio.pause();else if(t.containsClass(e.target,"clmns--control-stop"))t.calamansi.audio.stop();else if(t.containsClass(e.target,"clmns--control-next-track"))t.calamansi.nextTrack();else if(t.containsClass(e.target,"clmns--control-prev-track"))t.calamansi.prevTrack();else if(t.containsClass(e.target,"clmns--control-toggle-loop"))t.calamansi.toggleLoop();else if(t.containsClass(e.target,"clmns--control-toggle-shuffle"))t.calamansi.toggleShuffle();else if(t.containsClass(e.target,"clmns--slider")){var n,r=t.findElParent(e.target,"clmns--slider");n=r.classList.contains("clmns--slider-vertical")?1-(e.clientY-r.getBoundingClientRect().y)/r.clientHeight:(e.clientX-r.getBoundingClientRect().x)/r.clientWidth,t.onSliderPositionChanged(r,n)}})),document.addEventListener("mousemove",(function(e){if(t.calamansi.audio&&t.mouseDownTarget&&t.containsClass(t.mouseDownTarget,"clmns--slider")){var n,r=t.findElParent(t.mouseDownTarget,"clmns--slider");(n=r.classList.contains("clmns--slider-vertical")?1-(e.clientY-r.getBoundingClientRect().y)/r.clientHeight:(e.clientX-r.getBoundingClientRect().x)/r.clientWidth)>1?n=1:n<0&&(n=0),t.onSliderPositionChanged(r,n)}})),document.addEventListener("touchmove",(function(e){if(t.calamansi.audio&&t.mouseDownTarget&&t.containsClass(t.mouseDownTarget,"clmns--slider")){var n,r=t.findElParent(t.mouseDownTarget,"clmns--slider");(n=r.classList.contains("clmns--slider-vertical")?1-(e.touches[0].clientY-r.getBoundingClientRect().y)/r.clientHeight:(e.touches[0].clientX-r.getBoundingClientRect().x)/r.clientWidth)>1?n=1:n<0&&(n=0),t.onSliderPositionChanged(r,n)}})),this.getEls(".clmns--playback-rate").forEach((function(e){e.addEventListener("change",(function(n){t.calamansi.audio&&t.calamansi.audio.changePlaybackRate(parseFloat(e.value))}))}))}},{key:"addEventListeners",value:function(){var t=this;this.calamansi.on("loadedmetadata",(function(e){t.updatePlaybackDuration(e.audio.duration),t.updatePlaylist()})),this.calamansi.on("timeupdate",(function(e){t.updatePlaybackTime(e.audio.currentTime),t.updatePlaybackTimeLeft(e.audio.currentTime,e.audio.duration),t.updatePlaybackProgress(e.audio.currentTime,e.audio.duration)})),this.calamansi.on("loadingProgress",(function(e){t.updateLoadingProgress(e.audio.loadedPercent)})),this.calamansi.on("volumechange",(function(e){t.updateVolume(e.audio.volume)})),this.calamansi.on("trackInfoReady",(function(e,n){e.currentTrack().source===n.source&&t.updateTrackInfo(),t.updatePlaylist()})),this.calamansi.on("playlistLoaded",(function(e){t.updatePlaylist()})),this.calamansi.on("playlistReordered",(function(e){t.updatePlaylist()})),this.calamansi.on("trackSwitched",(function(e){t.updateTrackInfo(),t.updatePlaylistActiveTrack()}))}},{key:"getEl",value:function(t){return this.el.querySelector("".concat(t))}},{key:"getEls",value:function(t){return this.el.querySelectorAll("#".concat(this.el.id," ").concat(t))}},{key:"findEl",value:function(t,e){return t.querySelector(e)}},{key:"findEls",value:function(t,e){return t.querySelectorAll(e)}},{key:"findElParent",value:function(t,e){return t.classList?t.classList.contains(e)?t:t.parentNode?this.findElParent(t.parentNode,e):null:null}},{key:"containsClass",value:function(t,e){return t.classList.contains(e)||this.findElParent(t,e)}},{key:"onSliderPositionChanged",value:function(t,e){t.classList.contains("clmns--playback-bar")?this.calamansi.audio.seekTo(e*this.calamansi.audio.duration):t.classList.contains("clmns--volume-bar")&&this.calamansi.audio.changeVolume(e)}},{key:"updatePlaybackDuration",value:function(t){var e=this;this.getEls(".clmns--playback-duration").forEach((function(n){n.innerText=e.formatTime(t)}))}},{key:"updatePlaybackTime",value:function(t){var e=this;this.getEls(".clmns--playback-time").forEach((function(n){n.innerText=e.formatTime(t)}))}},{key:"updatePlaybackTimeLeft",value:function(t,e){var n=this;this.getEls(".clmns--playback-time-left").forEach((function(r){var i=e-Math.floor(t);r.innerText="-"+n.formatTime(i)}))}},{key:"updatePlaybackProgress",value:function(t,e){var n=this,r=t/e*100;this.getEls(".clmns--playback-progress").forEach((function(t){var e=n.findElParent(t,"clmns--slider");e&&(t.style[e.classList.contains("clmns--slider-vertical")?"height":"width"]=r+"%")})),this.getEls(".clmns--playback-bar").forEach((function(t){t.title="".concat(n.formatTime(n.calamansi.audio.currentTime)," / ").concat(n.formatTime(n.calamansi.audio.duration))}))}},{key:"updateLoadingProgress",value:function(t){this.getEls(".clmns--playback-load").forEach((function(e){e.style.width=t+"%"}))}},{key:"updateVolume",value:function(t){var e=this;this.getEls(".clmns--volume-value").forEach((function(n){var r=e.findElParent(n,"clmns--slider");r&&(n.style[r.classList.contains("clmns--slider-vertical")?"height":"width"]=100*t+"%")}))}},{key:"formatTime",value:function(t){var e=t>1?Math.floor(t/60/60):0,n=t>1?Math.floor(t/60):0;return n>=60&&(n-=60*e),(t=Math.floor(t))>=60&&(t-=60*n),t<10&&(t="0".concat(t)),n<10&&(n="0".concat(n)),e<10&&(e="0".concat(e)),0!=e?"".concat(e,":").concat(n,":").concat(t):"".concat(n,":").concat(t)}},{key:"updateCheckboxes",value:function(){var t=this;this.getEls(".clmns--control-toggle-loop").forEach((function(e){e.checked=t.calamansi._options.loop})),this.getEls(".clmns--control-toggle-shuffle").forEach((function(e){e.checked=t.calamansi._options.shuffle}))}},{key:"updatePlaylistList",value:function(){var t=this,e=this.getEl(".clmns--playlists");if(e){var n=!0,r=!1,i=void 0;try{for(var a,o=e.children[Symbol.iterator]();!(n=(a=o.next()).done);n=!0){var s=a.value;e.removeChild(s)}}catch(t){r=!0,i=t}finally{try{n||null==o.return||o.return()}finally{if(r)throw i}}for(var u in this.calamansi._playlists){var l=this.calamansi._playlists[u],c=document.createElement("option");c.value=u,c.innerText=l.name,e.appendChild(c)}e.addEventListener("change",(function(n){t.calamansi.switchPlaylist(e.value)}))}}},{key:"updatePlaylist",value:function(){var t=this;this.calamansi.currentPlaylist()&&this.getEls(".clmns--playlist").forEach((function(e){"table"===e.nodeName.toLowerCase()?t.updatePlaylistTable(e):t.updatePlaylistUl(e)}))}},{key:"updatePlaylistUl",value:function(t){var e=this;t.querySelector("ul")&&t.removeChild(t.querySelector("ul"));var n=document.createElement("ul"),r=this.findEl(t,".clmns--playlist-item.clmns--template");r&&(r=r.cloneNode(!0)).classList.remove("clmns--template");var i=0,a=!0,o=!1,s=void 0;try{for(var u,l=this.calamansi._currentPlaylistOrder[Symbol.iterator]();!(a=(u=l.next()).done);a=!0){var c=u.value,f=this.calamansi.currentPlaylist().list[c],h=f.info,d=document.createElement("li");if(r){var p=r.cloneNode(!0);this.updateFields(p,"clmns--playlist-track-info",h),f===this.calamansi.currentTrack()&&p.classList.add("clmns--active"),d.appendChild(p)}else d.innerText=f.info.name,d.title=f.info.name;d.classList.add("clmns--playlist-item-li"),d.dataset.index=i,d.addEventListener("click",(function(t){if(!t.target.classList.contains("clmns--link")){var n=e.findElParent(t.target,"clmns--playlist-item-li");e.calamansi.switchTrack(parseInt(n.dataset.index),!0)}})),n.appendChild(d),i++}}catch(t){o=!0,s=t}finally{try{a||null==l.return||l.return()}finally{if(o)throw s}}t.appendChild(n)}},{key:"updatePlaylistTable",value:function(t){var e=this,n=this.findEl(t,"tbody");if(n){var r=!0,i=!1,a=void 0;try{for(var o,s=this.findEls(n,"tr")[Symbol.iterator]();!(r=(o=s.next()).done);r=!0){var u=o.value;u.classList.contains("clmns--template")||n.removeChild(u)}}catch(t){i=!0,a=t}finally{try{r||null==s.return||s.return()}finally{if(i)throw a}}var l=this.findEl(n,".clmns--playlist-item.clmns--template");if(l){var c=0,f=!0,h=!1,d=void 0;try{for(var p,y=this.calamansi._currentPlaylistOrder[Symbol.iterator]();!(f=(p=y.next()).done);f=!0){var g=p.value,m=this.calamansi.currentPlaylist().list[g],v=m.info,_=l.cloneNode(!0);_.classList.remove("clmns--template"),this.updateFields(_,"clmns--playlist-track-info",v),m===this.calamansi.currentTrack()&&_.classList.add("clmns--active"),_.dataset.index=c,_.addEventListener("click",(function(t){if(!t.target.classList.contains("clmns--link")){var n=e.findElParent(t.target,"clmns--playlist-item");e.calamansi.switchTrack(parseInt(n.dataset.index),!0)}})),n.appendChild(_),c++}}catch(t){h=!0,d=t}finally{try{f||null==y.return||y.return()}finally{if(h)throw d}}t.appendChild(n)}else console.error(".clmns--playlist element should contain a row template!")}else console.error(".clmns--playlist element should contain <tbody> with a template row!")}},{key:"updatePlaylistActiveTrack",value:function(){var t=this;this.getEls(".clmns--playlist-item.clmns--active").forEach((function(e){e.classList.remove("clmns--active");var n=t.getEls(".clmns--playlist-item:not(.clmns--template)")[t.calamansi._currentTrack];n&&n.classList.add("clmns--active")}))}},{key:"updateTrackInfo",value:function(){if(this.calamansi.currentTrack()&&this.calamansi.currentTrack().info){var t=this.calamansi.currentTrack().info;this.updateFields(this.el,"clmns--track-info",t)}}},{key:"updateFields",value:function(t,e,n){var r=this;this.findEls(t,".".concat(e)).forEach((function(t){for(var i=null,a=0;a<t.classList.length;a++)if(new RegExp("".concat(e,"--.*")).test(t.classList[a])){i=t.classList[a].split("--")[2];break}if(i){if(t.classList.contains("clmns--link"))return t.setAttribute("href",n[i]?n[i]:"#"),void(t.style.visibility=n[i]?"visible":"collapse");switch(i){case"albumCover":"img"===t.nodeName.toLowerCase()?t.src=n[i]?n[i].base64:r.calamansi._options.defaultAlbumCover:t.style.backgroundImage="url('".concat(n[i]?n[i].base64:r.calamansi._options.defaultAlbumCover,"')");break;case"duration":t.innerHTML=n[i]?r.formatTime(n[i]):"&nbsp;",t.title=n[i]?r.formatTime(n[i]):"";break;default:t.innerHTML=n[i]?n[i]:"&nbsp;",t.title=n[i]?n[i]:""}}}))}},{key:"destroy",value:function(){this.el.className="",this.el.innerHTML=this.content}}])&&l(e.prototype,n),r&&l(e,r),t}();function f(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var h=n(4),d=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.soundcloudClientId=e}var e,n,r;return e=t,(n=[{key:"read",value:function(t){switch(t.sourceType){case"mp3":return this.readId3(t);case"soundcloud":return this.readSoundcloud(t)}}},{key:"readId3",value:function(t){return new Promise((function(e,n){var r;r=t.source.startsWith("http")?t.source:t.source.startsWith("/")?window.location.origin+t.source:window.location.origin+window.location.pathname+t.source,h.read(r,{onSuccess:function(t){var n=t.tags;if(n.artist&&n.title&&(n.name="".concat(n.artist," - ").concat(n.title)),n.title&&(n.titleOrFilename=n.title),n.artist&&(n.artistOrFilename=n.artist),n.track&&(n.trackNumber=parseInt(n.track.split("/")[0])),n.picture){var r=btoa(String.fromCharCode.apply(null,n.picture.data));n.picture=Object.assign(n.picture,{base64:"data:"+n.picture.format+";base64,"+r}),n.albumCover=n.picture}(t.tags.TYER||t.tags.TDRC)&&(n.year=t.tags.TYER?parseInt(t.tags.TYER.data):t.tags.TDRC?parseInt(t.tags.TDRC.data):null),n._loaded=!0,e(n)},onError:function(t){n(t)}})}))}},{key:"readSoundcloud",value:function(t){return new Promise((function(t,e){}))}}])&&f(e.prototype,n),r&&f(e,r),t}();function p(t,e,n,r,i,a,o){try{var s=t[a](o),u=s.value}catch(t){return void n(t)}s.done?e(u):Promise.resolve(u).then(r,i)}function y(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var g=function(){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._options=Object.assign({loop:!1,shuffle:!1,volume:100,preloadTrackInfo:!1,loadTrackInfoOnPlay:!0,defaultAlbumCover:"",soundcloudClientId:""},n);try{this._validateOptions()}catch(t){return void console.error("Calamansi intialization error: ".concat(t))}this._initialized=!1,this._trackInfoReader=new d(this._options.soundcloudClientId),this.el=e,this.id=e.id?e.id:this._generateUniqueId(),this._eventListeners={initialized:[],play:[],pause:[],stop:[],trackEnded:[],loadeddata:[],loadedmetadata:[],canplaythrough:[],loadingProgress:[],timeupdate:[],volumechange:[],ratechange:[],playlistLoaded:[],playlistReordered:[],playlistSwitched:[],trackInfoReady:[],trackSwitched:[]},this._skin=null,this.audio=null,this._playlists=[],this._currentPlaylist=null,this._currentTrack=null,this._currentPlaylistOrder=[],this._init()}var e,n,r,a,s;return e=t,n=[{key:"_validateOptions",value:function(){if(!this._options.skin)throw"No skin provided."}},{key:"_init",value:(a=i.a.mark((function t(){return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this._preparePlaylists(),this._registerEventListeners(),this._skin=new c(this,this._options.skin),t.next=5,this._skin.init();case 5:this.el=document.getElementById(this.id),this._initialized=!0,this._emit("initialized",this),CalamansiEvents._emit("initialized",this),this._loadPlaylist(this.currentPlaylist()),this.audio&&this.audio.changeVolume(this._options.volume/100);case 11:case"end":return t.stop()}}),t,this)})),s=function(){var t=this,e=arguments;return new Promise((function(n,r){var i=a.apply(t,e);function o(t){p(i,n,r,o,s,"next",t)}function s(t){p(i,n,r,o,s,"throw",t)}o(void 0)}))},function(){return s.apply(this,arguments)})},{key:"_generateUniqueId",value:function(){var t=Math.random().toString(36).substr(2,5);return document.querySelectorAll("calamansi-".concat(t)).length>0?this._generateUniqueId():"calamansi-".concat(t)}},{key:"_preparePlaylists",value:function(){if(this._options.playlists&&Object.keys(this._options.playlists).length>0){var t=0;for(var e in this._options.playlists){var n={name:e,list:[]};if(Array.isArray(this._options.playlists[e])){var r=!0,i=!1,a=void 0;try{for(var o,s=this._options.playlists[e][Symbol.iterator]();!(r=(o=s.next()).done);r=!0){var u=o.value;u.source&&(u.info=u.info?u.info:{},u.info.url=u.source,u.info.filename=this._getTrackFilename(u),u.info.name=u.info.title?u.info.title:u.info.filename,u.info.titleOrFilename=u.info.title?u.info.title:u.info.filename,u.info.artistOrFilename=u.info.artist?u.info.artist:u.info.filename,u.sourceType=this._getTrackSourceType(u),n.list.push(u),this._options.preloadTrackInfo&&this._loadTrackInfo(u),null===this._currentPlaylist&&(this._currentPlaylist=t))}}catch(t){i=!0,a=t}finally{try{r||null==s.return||s.return()}finally{if(i)throw a}}this._playlists.push(n),t++}}null===this._currentPlaylist&&(this._currentPlaylist=0)}}},{key:"_loadPlaylist",value:function(t){t&&(this._options.shuffle?this._shuffleCurrentPlaylist(!1):this._unshuffleCurrentPlaylist(!1),this.switchTrack(0),this._emit("playlistLoaded",this),CalamansiEvents._emit("playlistLoaded",this))}},{key:"switchPlaylist",value:function(t){this._currentPlaylist=t,this._emit("playlistSwitched",this),CalamansiEvents._emit("playlistSwitched",this),this._loadPlaylist(this.currentPlaylist())}},{key:"_loadTrack",value:function(t){if(!this.audio)return this.audio=new o(this,t.source),void(this._options.loadTrackInfoOnPlay&&this._loadTrackInfo(t));this.audio.load(t.source),this._options.loadTrackInfoOnPlay&&this._loadTrackInfo(t)}},{key:"switchTrack",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this._currentTrack=t,this._emit("trackSwitched",this),CalamansiEvents._emit("trackSwitched",this),this._loadTrack(this.currentTrack()),e&&this.audio.play()}},{key:"_getTrackFilename",value:function(t){return t.source.startsWith("https://api.soundcloud.com")?t.source:t.source.split("/").pop()}},{key:"_getTrackSourceType",value:function(t){return t.source.startsWith("https://api.soundcloud.com")?"soundcloud":t.info.filename.split(".").pop()}},{key:"_loadTrackInfo",value:function(t){var e=this;!0!==t.info._loaded&&this._trackInfoReader.read(t).then((function(n){n._loaded&&(t.info=Object.assign(t.info,n),e._emit("trackInfoReady",e,t),CalamansiEvents._emit("trackInfoReady",e))}))}},{key:"currentPlaylist",value:function(){return this._playlists[this._currentPlaylist]}},{key:"currentTrack",value:function(){return this.currentPlaylist()?this.currentPlaylist().list[this._currentPlaylistOrder[this._currentTrack]]:null}},{key:"nextTrack",value:function(){return this._currentTrack+1<this.currentPlaylist().list.length?(this.switchTrack(this._currentTrack+1,!0),!0):!!this._options.loop&&(this.switchTrack(0,!0),!0)}},{key:"prevTrack",value:function(){return this._currentTrack-1>=0?(this.switchTrack(this._currentTrack-1,!0),!0):!!this._options.loop&&(this.switchTrack(this.currentPlaylist().list.length-1,!0),!0)}},{key:"toggleLoop",value:function(){this._options.loop=!this._options.loop}},{key:"toggleShuffle",value:function(){this._options.shuffle=!this._options.shuffle,this._options.shuffle?this._shuffleCurrentPlaylist():this._unshuffleCurrentPlaylist()}},{key:"_unshuffleCurrentPlaylist",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this._currentTrack=this._currentPlaylistOrder[this._currentTrack],this._currentPlaylistOrder=Object.keys(this.currentPlaylist().list).map((function(t){return parseInt(t)})),t&&(this._emit("playlistReordered",this),CalamansiEvents._emit("playlistReordered",this))}},{key:"_shuffleCurrentPlaylist",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(this.currentPlaylist().list.length>1){for(this._currentPlaylistOrder=[];this._currentPlaylistOrder.length<this.currentPlaylist().list.length;){var e=Math.floor(Math.random()*this.currentPlaylist().list.length);this._currentPlaylistOrder.indexOf(e)>-1||this._currentPlaylistOrder.push(e)}this._currentTrack=this._currentPlaylistOrder.indexOf(this._currentTrack)}else this._currentPlaylistOrder=[0];t&&(this._emit("playlistReordered",this),CalamansiEvents._emit("playlistReordered",this))}},{key:"destroy",value:function(){this.audio.unload(),this._skin.destroy()}},{key:"on",value:function(t,e){"string"==typeof t&&(t=[t]);var n=!0,r=!1,i=void 0;try{for(var a,o=t[Symbol.iterator]();!(n=(a=o.next()).done);n=!0){var s=a.value;this._eventListeners[s]&&this._eventListeners[s].push(e)}}catch(t){r=!0,i=t}finally{try{n||null==o.return||o.return()}finally{if(r)throw i}}}},{key:"_emit",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(this._initialized&&this._eventListeners[t]){var r=!0,i=!1,a=void 0;try{for(var o,s=this._eventListeners[t][Symbol.iterator]();!(r=(o=s.next()).done);r=!0){var u=o.value;u(e,n)}}catch(t){i=!0,a=t}finally{try{r||null==s.return||s.return()}finally{if(i)throw a}}document.querySelectorAll("#".concat(this._skin.el.id," .clmns--hide-on-").concat(t)).forEach((function(t){"none"!=t.style.display&&(t.dataset.display=t.style.display?t.style.display:"inline",t.style.display="none")})),document.querySelectorAll("#".concat(this._skin.el.id," .clmns--show-on-").concat(t)).forEach((function(t){t.style.display=t.dataset.display}))}}},{key:"_registerEventListeners",value:function(){var t=this;CalamansiEvents.on("play",(function(e){e.id!=t.id&&t.audio&&t.audio.pause()})),this.on("trackEnded",(function(e){t.nextTrack()||(t._emit("stop"),CalamansiEvents._emit("stop",t))}))}}],r=[{key:"autoload",value:function(){var e=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"calamansi",r=[],i=document.querySelectorAll(".".concat(n));return i.forEach((function(n){r.push(new t(n,e._readOptionsFromElement(n)))})),r}},{key:"_readOptionsFromElement",value:function(t){var e={};return e.skin=t.dataset.skin?t.dataset.skin:null,t.dataset.source&&(e.playlists={default:[{source:t.dataset.source}]}),e}}],n&&y(e.prototype,n),r&&y(e,r),t}();function m(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var v=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.eventListeners={initialized:[],play:[],pause:[],stop:[],trackEnded:[],loadeddata:[],loadedmetadata:[],canplaythrough:[],loadingProgress:[],timeupdate:[],volumechange:[],ratechange:[],playlistLoaded:[],playlistReordered:[],trackInfoReady:[],trackSwitched:[]}}var e,n,r;return e=t,(n=[{key:"_emit",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(this.eventListeners[t]){var r=!0,i=!1,a=void 0;try{for(var o,s=this.eventListeners[t][Symbol.iterator]();!(r=(o=s.next()).done);r=!0){var u=o.value;u(e,n)}}catch(t){i=!0,a=t}finally{try{r||null==s.return||s.return()}finally{if(i)throw a}}}}},{key:"on",value:function(t,e){"string"==typeof t&&(t=[t]);var n=!0,r=!1,i=void 0;try{for(var a,o=t[Symbol.iterator]();!(n=(a=o.next()).done);n=!0){var s=a.value;this.eventListeners[s]&&this.eventListeners[s].push(e)}}catch(t){r=!0,i=t}finally{try{n||null==o.return||o.return()}finally{if(r)throw i}}}}])&&m(e.prototype,n),r&&m(e,r),t}();window.Calamansi=g,window.CalamansiEvents=new v},function(t,e){}]);